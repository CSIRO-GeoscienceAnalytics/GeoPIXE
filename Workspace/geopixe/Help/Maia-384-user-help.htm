<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<title>Maia 384 Users Guide</title>

<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Arial Black";
	panose-1:2 11 10 4 2 1 2 2 2 4;}
@font-face
	{font-family:"DejaVu LGC Sans";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Arial Italic";
	panose-1:2 11 6 4 2 2 2 9 2 4;}
@font-face
	{font-family:"\@MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:42.55pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;
	layout-grid-mode:line;}
h1
	{margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:42.55pt;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Arial",sans-serif;
	layout-grid-mode:line;}
h2
	{margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:17.0pt;
	line-height:12.0pt;
	font-size:12.0pt;
	font-family:"Arial",sans-serif;
	layout-grid-mode:line;
	font-style:italic;}
h3
	{margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:1.0cm;
	line-height:12.0pt;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;
	layout-grid-mode:line;}
h4
	{margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:35.45pt;
	page-break-after:avoid;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;
	layout-grid-mode:line;
	font-style:italic;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	font-size:12.0pt;
	font-family:"Arial Black",sans-serif;
	layout-grid-mode:line;
	font-weight:bold;}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:6.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:9.9pt;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;
	layout-grid-mode:line;
	font-weight:bold;}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:20.0pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;
	layout-grid-mode:line;}
p.MsoFootnoteText, li.MsoFootnoteText, div.MsoFootnoteText
	{margin:0cm;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:42.55pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;
	layout-grid-mode:line;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:42.55pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;
	layout-grid-mode:line;}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{margin-top:6.0pt;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	line-height:11.0pt;
	font-size:9.0pt;
	font-family:"Arial",sans-serif;
	font-style:italic;}
span.MsoFootnoteReference
	{vertical-align:super;}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:42.55pt;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:#954F72;
	text-decoration:underline;}
em
	{font-family:"Times New Roman",serif;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:42.55pt;
	font-size:8.0pt;
	font-family:"Tahoma",sans-serif;
	layout-grid-mode:line;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;
	layout-grid-mode:line;}
p.NotHeading1, li.NotHeading1, div.NotHeading1
	{mso-style-name:"Not Heading 1";
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	font-size:18.0pt;
	font-family:"Arial",sans-serif;
	layout-grid-mode:line;}
p.AuthorList, li.AuthorList, div.AuthorList
	{mso-style-name:"Author List";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:12.0pt;
	margin-left:3.0cm;
	text-align:right;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;}
p.Affiliations, li.Affiliations, div.Affiliations
	{mso-style-name:Affiliations;
	margin:0cm;
	text-align:center;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;
	font-style:italic;}
span.StrongEmphasis
	{mso-style-name:"Strong Emphasis";
	font-family:"Times New Roman",serif;
	font-weight:bold;}
 /* Page Definitions */
 @page WordSection1
	{size:595.3pt 841.9pt;
	margin:36.0pt 36.0pt 36.0pt 36.0pt;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>

</head>

<body lang=EN-AU link=blue vlink="#954F72" style='word-wrap:break-word'>

<div class=WordSection1>

<p class=MsoHeader><a name="_Toc216705030"></a><a name="_Toc225587841"></a><a
name="_Toc228595071">&nbsp;</a></p>

<p class=MsoHeader>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=right style='text-align:right'><span lang=FR
style='layout-grid-mode:both'><img width=325 height=207 id="Picture 44"
src="Maia-384-user-help_files/image001.png"
alt="Logo, company name&#13;&#10;&#13;&#10;Description automatically generated"></span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=right style='text-align:right'><a name="_Toc18816515">             </a><a
name="_Toc235591157"></a></p>

<p class=MsoNormal>&nbsp;</p>

<h1 style='margin-left:0cm'><a name="_Toc208917315"><span style='font-size:
30.0pt'>Maia 384 Users Guide</span></a><span style='font-size:30.0pt'>                </span></h1>

<p class=MsoNormal style='margin-left:0cm'><a name="_Toc18817037"></a><a
name="_Toc18817320"></a><a name="_Toc18907855"></a><a name="_Toc18929288"></a><a
name="_Toc18816516"><span style='font-size:18.0pt;font-family:"Arial",sans-serif'>Real-time
SXRF Trace Element</span></a><span style='font-size:18.0pt;font-family:"Arial",sans-serif'>
Imaging and Analysis</span></p>

<p class=MsoNormal style='margin-left:0cm'><span style='font-size:18.0pt;
font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:0cm'><span style='font-size:18.0pt;
font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:0cm'><span style='font-size:18.0pt;
font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:0cm'><span style='font-size:18.0pt;
font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal align=right style='margin-top:18.0pt;margin-right:0cm;
margin-bottom:6.0pt;margin-left:42.55pt;text-align:right'><span
style='font-family:"Arial Black",sans-serif'>The Maia 384 detector array and
imaging system</span></p>

<p class=AuthorList><span lang=EN-US>R. Kirkham<sup>1</sup>, D.P. Siddons<sup>2</sup>,
P.A. Dunn<sup>1</sup>, A. Kuczewski<sup>2</sup>, C.G. Ryan<sup>3,6</sup>, G.F.
Moorhead<sup>3,6</sup>, G. De Geronimo<sup>4</sup>, M. Jensen<sup>1</sup>, R.
Beuttenmuller<sup>4</sup>, D. Pinelli<sup>4</sup>, M. Pfeffer<sup>2</sup>, P.
Davey<sup>1</sup> and R. Dodanwela<sup>1</sup></span></p>

<p class=MsoNormal align=right style='margin-top:18.0pt;margin-right:0cm;
margin-bottom:6.0pt;margin-left:42.55pt;text-align:right'><span
style='font-family:"Arial Black",sans-serif'>Beamline integration at the X-ray
Fluorescence Microprobe beamline</span></p>

<p class=AuthorList><span lang=EN-US>D. Paterson<sup>5</sup>, M.D. de Jonge<sup>5</sup>,
D. Howard<sup>5</sup>, M. Küsel<sup>5</sup> and J. McKinlay<sup>5</sup></span></p>

<p class=AuthorList><span lang=EN-US>&nbsp;</span></p>

<p class=Affiliations align=right style='text-align:right'><sup><span
lang=EN-US style='font-size:10.0pt'>1</span></sup><span lang=EN-US
style='font-size:10.0pt'> CSIRO Materials Science and Engineering, Clayton VIC,
  Australia</span></p>

<p class=Affiliations align=right style='text-align:right'><sup><span
lang=EN-US style='font-size:10.0pt'>2</span></sup><span lang=EN-US
style='font-size:10.0pt'> National Synchrotron Light Source, Brookhaven
National Laboratory, NY, USA</span></p>

<p class=Affiliations align=right style='text-align:right'><sup><span
lang=EN-US style='font-size:10.0pt'>3</span></sup><span lang=EN-US
style='font-size:10.0pt'> CSIRO Mineral Resources, Clayton VIC, Australia</span></p>

<p class=Affiliations align=right style='text-align:right'><sup><span
lang=EN-US style='font-size:10.0pt'>4</span></sup><span lang=EN-US
style='font-size:10.0pt'> Instrumentation Division, Brookhaven National
Laboratory, Brookhaven NY, USA</span></p>

<p class=Affiliations align=right style='text-align:right'><sup><span
lang=EN-US style='font-size:10.0pt;font-style:normal'>5</span></sup><span
lang=EN-US style='font-size:10.0pt;font-style:normal'> Australian Synchrotron, </span><span
lang=EN-US style='font-size:10.0pt'>Clayton</span><span lang=EN-US
style='font-size:10.0pt;font-style:normal'>, VIC, Australia</span></p>

<p class=Affiliations align=right style='text-align:right'><sup><span
lang=EN-US style='font-size:10.0pt'>6</span></sup><span lang=EN-US
style='font-size:10.0pt'> School of Physics, University of Melbourne, Parkville
VIC, Australia</span></p>

<p class=MsoHeader style='margin-right:20.0pt'><span style='font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<b><i><span style='font-size:12.0pt;font-family:"Arial",sans-serif;layout-grid-mode:
line'><br clear=all style='page-break-before:always'>
</span></i></b>

<h2 align=center style='margin-left:0cm;text-align:center'><a
name="_Toc18817040"></a><a name="_Toc235591158"></a><a name="_Toc208917316">Table
of Contents</a></h2>

<p class=MsoToc1><a
href="#_Toc208917315">Maia 384 Users Guide<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></p>

<p class=MsoToc2><a href="#_Toc208917316">Table of Contents<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>2</span></a></p>

<p class=MsoToc2><a href="#_Toc208917317">Overview<span style='color:windowtext;
display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>4</span></a></p>

<p class=MsoToc2><a href="#_Toc208917318">Installation Notes<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>5</span></a></p>

<p class=MsoToc3><a href="#_Toc208917319">HYMOD:<span style='color:windowtext;
display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>5</span></a></p>

<p class=MsoToc3><a href="#_Toc208917320">Beamline GUI computer:<span
style='color:windowtext;display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>6</span></a></p>

<p class=MsoToc3><a href="#_Toc208917321">blogd file server<span
style='color:windowtext;display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>7</span></a></p>

<p class=MsoToc2><a href="#_Toc208917322">Preliminary Safe Operating Procedures<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>8</span></a></p>

<p class=MsoToc3><a href="#_Toc208917323">Cautions<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>8</span></a></p>

<p class=MsoToc3><a href="#_Toc208917324">Emergency Shutdown<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>8</span></a></p>

<p class=MsoToc3><a href="#_Toc208917325">Detector Set-up<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>8</span></a></p>

<p class=MsoToc3><a href="#_Toc208917326">Detector Operation<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>9</span></a></p>

<p class=MsoToc2><a href="#_Toc208917327">Pulse capture in Maia<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>11</span></a></p>

<p class=MsoToc3><a href="#_Toc208917328">Detector Array<span style='color:
windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>11</span></a></p>

<p class=MsoToc3><a href="#_Toc208917329">HERMES Pre-amplifier, Shaper<span
style='color:windowtext;display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>11</span></a></p>

<p class=MsoToc3><a href="#_Toc208917330">SCEPTER Pulse Capture<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>11</span></a></p>

<p class=MsoToc3><a href="#_Toc208917331">ADCs<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>12</span></a></p>

<p class=MsoToc2><a href="#_Toc208917332">Data processing Pipeline<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>12</span></a></p>

<p class=MsoToc3><a href="#_Toc208917333">Event correction<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>13</span></a></p>

<p class=MsoToc3><a href="#_Toc208917334">ET event buffering<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>14</span></a></p>

<p class=MsoToc3><a href="#_Toc208917335">DA and ROI imaging<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>14</span></a></p>

<p class=MsoToc3><a href="#_Toc208917336">ET Spectra<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>14</span></a></p>

<p class=MsoToc3><a href="#_Toc208917337">Group Spectra<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>14</span></a></p>

<p class=MsoToc3><a href="#_Toc208917338">Energy-Time Histogram<span
style='color:windowtext;display:none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>14</span></a></p>

<p class=MsoToc3><a href="#_Toc208917339">Activity<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>15</span></a></p>

<p class=MsoToc2><a href="#_Toc208917340">Maia Control User Interface<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>15</span></a></p>

<p class=MsoToc3><a href="#_Toc208917341">Maia Control Windows<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>16</span></a></p>

<p class=MsoToc2><a href="#_Toc208917342">Maia Detector Setup window<span
style='color:windowtext;display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>25</span></a></p>

<p class=MsoToc3><a href="#_Toc208917343">Enable<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>25</span></a></p>

<p class=MsoToc3><a href="#_Toc208917344">HERMES<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>26</span></a></p>

<p class=MsoToc3><a href="#_Toc208917345">SCEPTER<span style='color:windowtext;
display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>26</span></a></p>

<p class=MsoToc3><a href="#_Toc208917346">HYMOD<span style='color:windowtext;
display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>29</span></a></p>

<p class=MsoToc3><a href="#_Toc208917347">Summary<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>30</span></a></p>

<p class=MsoToc3><a href="#_Toc208917348">Groups<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>31</span></a></p>

<p class=MsoToc3><a href="#_Toc208917349">Imaging<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>32</span></a></p>

<p class=MsoToc3><a href="#_Toc208917350">Controls<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>33</span></a></p>

<p class=MsoToc3><a href="#_Toc208917351">Layout<span style='color:windowtext;
display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>34</span></a></p>

<p class=MsoToc3><a href="#_Toc208917352">Pulser / Tests<span style='color:
windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>34</span></a></p>

<p class=MsoToc3><a href="#_Toc208917353">Debug<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>35</span></a></p>

<p class=MsoToc1><a href="#_Toc208917354">Maia Pipeline Set-up<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>37</span></a></p>

<p class=MsoToc2><a href="#_Toc208917355">Setting Thresholds<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>37</span></a></p>

<p class=MsoToc3><a href="#_Toc208917356">Thresh<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>37</span></a></p>

<p class=MsoToc3><a href="#_Toc208917357">Trim<span style='color:windowtext;
display:none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>37</span></a></p>

<p class=MsoToc2><a href="#_Toc208917358">Detector Linearization<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>37</span></a></p>

<p class=MsoToc3><a href="#_Toc208917359">Running “step-cal”<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>38</span></a></p>

<p class=MsoToc3><a href="#_Toc208917360">Executing Linearization plug-in<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>38</span></a></p>

<p class=MsoToc3><a href="#_Toc208917361">Linearization using X-ray standard
spectra<span style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>41</span></a></p>

<p class=MsoToc3><a href="#_Toc208917362">Linearization using Peak Offsets in
Fit<span style='color:windowtext;display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>43</span></a></p>

<p class=MsoToc2><a href="#_Toc208917363">Gain Trimming<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>43</span></a></p>

<p class=MsoToc3><a href="#_Toc208917364">Running the “gain-trim” pulser<span
style='color:windowtext;display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>44</span></a></p>

<p class=MsoToc3><a href="#_Toc208917365">Executing the Gain Trimming Plug-in<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>45</span></a></p>

<p class=MsoToc3><a href="#_Toc208917366">Gain-trim adjustment after minor TRIM
or THRESH changes<span style='color:windowtext;display:none;text-decoration:
none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>47</span></a></p>

<p class=MsoToc3><a href="#_Toc208917367">Gain-trim using a dual X-ray source<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>47</span></a></p>

<p class=MsoToc3><a href="#_Toc208917368">Gain Trim Adjustment using a source<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>49</span></a></p>

<p class=MsoToc2><a href="#_Toc208917369">Pile-up Rejection<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>50</span></a></p>

<p class=MsoToc2><a href="#_Toc208917370">Energy Calibration<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>51</span></a></p>

<p class=MsoToc3><a href="#_Toc208917371">A single energy cal for all<span
style='color:windowtext;display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>51</span></a></p>

<p class=MsoToc3><a href="#_Toc208917372">Individual energy calibrations<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>51</span></a></p>

<p class=MsoToc3><a href="#_Toc208917373">Rough Initial energy calibration<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>52</span></a></p>

<p class=MsoToc2><a href="#_Toc208917374">Detector Energy Resolution<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>53</span></a></p>

<p class=MsoToc3><a href="#_Toc208917375">Acquire spectra<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>53</span></a></p>

<p class=MsoToc3><a href="#_Toc208917376">Fit spectra &amp; display FWHM<span
style='color:windowtext;display:none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>53</span></a></p>

<p class=MsoToc2><a href="#_Toc208917377">Relative Noise Width<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>55</span></a></p>

<p class=MsoToc3><a href="#_Toc208917378">Acquire spectra<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>55</span></a></p>

<p class=MsoToc3><a href="#_Toc208917379">Fit spectra &amp; display FWHM<span
style='color:windowtext;display:none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>55</span></a></p>

<p class=MsoToc2><a href="#_Toc208917380">Using Throttle to Control Data-rates<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>57</span></a></p>

<p class=MsoToc3><a href="#_Toc208917381">Representative Spectrum<span
style='color:windowtext;display:none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>58</span></a></p>

<p class=MsoToc3><a href="#_Toc208917382">Enabling Throttle in Maia<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>58</span></a></p>

<p class=MsoToc1><a href="#_Toc208917383">Maia Data Analysis<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>59</span></a></p>

<p class=MsoNormal><b><span style='font-size:12.0pt;font-family:"Arial Black",sans-serif'>&nbsp;</span></b></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>This guide is an initial draft to cover set-up and operation
of the Maia detector system. It provides a basic overview of the detector
hardware and software; for details please consult the detailed detector
documentation.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><b>GeoPIXE</b></p>

<p class=MsoNormal>This guide is a supplement to the GeoPIXE manual to cater
for Maia-384 SXRF image data. More up to data worked examples relating to Maia
calibration can be found in the “<b>GeoPIXE Worked Example Notes.pdf</b>” in
the “geopixe/Help” directory.</p>

<b><i><span style='font-size:12.0pt;font-family:"Arial",sans-serif;layout-grid-mode:
line'><br clear=all style='page-break-before:always'>
</span></i></b>

<h2><a name="_Toc208917317">Overview</a></h2>

<p class=MsoNormal>The figure below provides an overview of the major Maia
system components. The Safe Operating Procedures section provides brief notes
of system set-up and operating rules. This is followed by more detailed notes
on the data processing pipeline and the use of the <i>Maia Control </i>program.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Modules in the detector head (orange boxes):</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Maia</b>:
the detector array</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>DAM</b>
(detector analogue module): is the board in the Maia vacuum chamber carrying
the pulse processing ASICs HERMES (32 channel pre-amp quasi-Gaussian shapers)
and SCEPTER (32 channel pulse capture, derandomizer). It receives signals from
the Maia array for pulse amplitude, related to energy (E), and
time-over-threshold (T).</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>DDM</b>
(digital detector module): is the board in the Maia detector module carrying
the ADCs for digitizing the E and T signals and an FPGA to package them for transmission
to the HYMOD processor through an optic fibre link.</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>DBPM</b>
(Detector Bias-Peltier Module): is the board in the Maia detector module
carrying the Peltier cooling and bias drivers.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Modules in the Maia processing rack (located outside the
hutch and connected via an optical link to the detector head; yellow boxes):</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>HYMOD</b>:
the FPGA based real-time processing board that executes the data-flow pipeline.</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Kandinski</b>:
the Maia supervisor program that runs in the HYMOD coprocessor. It provides a
socket interface for EPICS control and read-back via the <i>Maia Control</i>
GUI.</p>

<p class=MsoNormal style='margin-left:17.0pt'><img width=562 height=507
src="Maia-384-user-help_files/image002.jpg"></p>

<p class=MsoNormal style='margin-left:17.0pt'><i>Overview of the Maia system
(this diagram is also available on the “System Layout” tab of the Maia Detector
Setup window of the Maia Control GUI). Some systems will implement an
alternative to the Epics IOC (e.g. Tango, Spec) to push/pull parameters
into/from the Kandinski socket interface.</i></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Software modules residing on the beamline or file server
Linux workstations (pink boxes):</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>csiro-blogd</b>:
A logging server that writes data records to disk and serves out data records
on request to clients (e.g. the Maia Control GUI).</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>EPICS
IOC</b>: Control IOC running on the beamline EPICS system to control Maia and
provide Maia with parameters it needs for pixellation of images during
scanning. <i>Some systems will implement an alternative to the Epics IOC (e.g.
Tango, Spec) to push/pull parameters into/from the Kandinski socket interface.</i></p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>varsh</b>:
A low level command driven control program. This is <b>NOT FOR USERS</b>; users
should use the<i> Maia Control</i> GUI. It is used by beamline personnel for
direct access to Maia registers. <b>Direct access to Maia via <i>varsh</i> may
cause damage to the detector and should not be used by users.</b></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Software modules running on a beamline computer (Windows or
Linux):</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b><i>Maia
Control</i> GUI</b>: IDL program that provides the main user interface for setting
up Maia and for monitoring Maia operation.</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b><i>GeoPIXE</i></b>:
IDL program for off-line data reduction and occasional generation of calibration
parameter files for input into <i>Maia Control</i>.</p>

<p class=MsoNormal style='margin-left:0cm'>&nbsp;</p>

<h2><a name="_Toc208917318">Installation Notes</a></h2>

<p class=MsoNormal><i>These notes provide a basic check-list indicating the
interconnected components. See the Maia documentation for details.</i></p>

<p class=MsoNormal style='margin-left:0cm'>&nbsp;</p>

<p class=MsoNormal style='margin-left:0cm'>&nbsp;</p>

<p class=MsoNormal>The entire Maia system pictured above is accommodated across
2 or 3 nodes.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:0cm'><span style='layout-grid-mode:both'><img
width=697 height=496 id="Picture 1" src="Maia-384-user-help_files/image003.jpg"></span></p>

<h3><a name="_Toc208917319">HYMOD:</a></h3>

<p class=MsoNormal style='margin-left:96.55pt;text-indent:-18.0pt'>a.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>The HYMOD FPGA processor has a coprocessor running Linux. HYMOD has two
Ethernet ports: (i) eth0 typically connects to the beamline network and is used
for client traffic, and (ii) eth1 provides an optional dedicated Ethernet link
between the HYMOD Linux coprocessor and the file server running the blogd event
logging daemon. The main service running on the HYMOD Linux processor is:</p>

<p class=MsoNormal style='margin-left:96.55pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:96.55pt;text-indent:-18.0pt'>b.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Kandinski:</p>

<p class=MsoNormal style='margin-left:132.55pt;text-indent:-132.55pt'><span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>i.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Kandinski runs to handle Maia control and service requests via a socket
connection from clients running on other nodes. These clients include: (i) Maia
Control, which provides a GUI interface to Kandinski and Maia, (ii) varsh,
which provides a low-level access to internal Kandinski variables via a command
driven console, and (iii) an EPICS or Tango IOC. Kandinski maintains a copy of
all variables reflecting: (i) DAM parameters for the ASICS HERMES and SCEPTER,
(ii) DBPM parameters for Peltier and bias, (iii) DDM parameters for ADC control
and (iv) parameters for the FPGA processing pipeline.</p>

<h3><a name="_Toc208917320">Beamline GUI computer:</a></h3>

<p class=MsoNormal style='margin-left:96.55pt;text-indent:-18.0pt'>c.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>One of the beamline computers can act as a host for clients to access
Maia. These include:</p>

<p class=MsoNormal style='margin-left:60.55pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:96.55pt;text-indent:-18.0pt'>d.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Maia
Control:</p>

<p class=MsoNormal style='margin-left:132.55pt;text-indent:-132.55pt'><span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>i.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>An IDL GUI program providing a real-time view of Maia parameters, event
data (such as spectra and images) and methods for set-up and calibration of the
processing pipeline. Multiple Maia Control clients can be run on various Linux
or Windows computers on the local beamline network. However, avoid running two
instances of Maia Control on one node connected to a single Maia. This GUI is
used by beamline staff for Maia set-up and calibration, and by users for some
operations, such as establishing Throttle vectors or setting a refined DA
real-time imaging matrix.</p>

<p class=MsoNormal style='margin-left:132.55pt;text-indent:-132.55pt'><span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>ii.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>On startup, <i>Maia Control</i> will select from any config files it
finds (extension: “.Maia.conf”) in the user’s home .geopixe directory. This
file specifies the IP/Port for the Maia (Kandinski) socket to HYMOD and the
IP/Port for the blogger data logging process. </p>

<p class=MsoNormal style='margin-left:132.55pt;text-indent:-132.55pt'><span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>iii.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>An example of lines in a .Maia.conf file …</p>

<p class=MsoListParagraph>&nbsp;</p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-family:"Courier New"'>#     Maia
384/96 real-time detector set-up (only needed with a Maia detector)</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-family:"Courier New"'>#</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-family:"Courier New"'>#
defaults</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-family:"Courier New"'>#</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-family:"Courier New"'>      default
detectors 384         # actual: config.channels</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-family:"Courier New"'>      default
version         1     # actual: config.ps.version</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-family:"Courier New"'>      default
spectra         12    # actual: config.spectrum.number</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-family:"Courier New"'>      default
DA        32          # actual: config.da.number</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-family:"Courier New"'>#</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-family:"Courier New"'>#
shared memory for images</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-family:"Courier New"'>#</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-family:"Courier New"'>#     DA
image pixels will be compressed to fit into this physical range</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-family:"Courier New"'>#</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-family:"Courier New"'>      default
X         1000        # memory DA image X size</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-family:"Courier New"'>      default
Y         1000        # memory DA image Y size</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-family:"Courier New"'>#</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-family:"Courier New"'>#
Kandinski socket</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-family:"Courier New"'>#</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-family:"Courier New"'>      maia
ip 11.22.33.44           # IP address of Maia HYMOD</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-family:"Courier New"'>      maia
name Maia_256            # name (max 8 chars, alphanumeric + “_”)</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-family:"Courier New"'>      maia
port 9001</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-family:"Courier New"'>      maia
device MAIA_DEVICE</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-family:"Courier New"'>      maia
enable 1                 # Maia socket on/off</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-family:"Courier New"'>#</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-family:"Courier New"'>#
Blog server</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-family:"Courier New"'>#</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-family:"Courier New"'>      blog
ip 22.33.44.55           # blogger host node</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-family:"Courier New"'>      blog
port 9000</span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-family:"Courier New"'>      blog
enable 1                 # blog on/off</span></p>

<p class=MsoNormal style='margin-left:36.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:96.55pt;text-indent:-18.0pt'>e.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>varsh:</p>

<p class=MsoNormal style='margin-left:132.55pt;text-indent:-132.55pt'><span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>i.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>A low-level command driven console providing direct access to internal
Kandinski variables. This console should be used only be experienced beamline
and controls staff.</p>

<p class=MsoNormal style='margin-left:132.55pt;text-indent:-132.55pt'><span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>ii.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Run <i>varsh</i> by supplying the IP address of the Maia socket as the
first argument.</p>

<p class=MsoNormal style='margin-left:96.55pt;text-indent:-18.0pt'>f.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>EPICS IOC:</p>

<p class=MsoNormal style='margin-left:132.55pt;text-indent:-132.55pt'><span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>i.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>An EPICS IOC and MEDM panel (or equivalent) can be established (see XFM
beamline example from the Australian Synchrotron) to provide the ability to (i)
set selected Kandinski variables associated with a scan (e.g. scan XYZ origin,
pixel size, scan range) and metadata destined to be logged with the data (e.g.
beam energy, sample type and other details, etc.), and (ii) to read back status
information from Maia (e.g. count rates, run number, data volume logged, etc.).</p>

<p class=MsoNormal style='margin-left:132.55pt;text-indent:-132.55pt'><span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>ii.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>An equivalent Tango IOC and panel have been developed at the P06
beamline at DESY, Hamburg.</p>

<h3><a name="_Toc208917321">blogd file server</a></h3>

<p class=MsoNormal style='margin-left:96.55pt;text-indent:-18.0pt'>g.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Data
is logged over the dedicated eth1 Ethernet link to a file server. Initially
this may be the same local computer used for GUI clients, etc. Later you may
want to connect this Ethernet port over a dedicated link to a file server for
the beamline or sector. Ideally, this will continue to use a dedicated Ethernet
link of at least full 1 Gb/s capacity (if not shared) or a higher bandwidth if
shared in any way. The service logging data is:</p>

<p class=MsoNormal style='margin-left:96.55pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:96.55pt;text-indent:-18.0pt'>h.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>csiro-blogd:</p>

<p class=MsoNormal style='margin-left:132.55pt;text-indent:-132.55pt'><span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>i.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>blogd usually runs as a service daemon to service requests for socket
connections from (i) Kandinski in HYMOD for logging event data, and (ii) from
clients to request copies of selected requested event records as they pass by
(e.g. ET records or Rates). <i>blogd</i> also adds record time stamps and
records providing status information.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Typically, the HYMOD (Maia processing 19” rack unit) uses a
dedicated Ethernet link (eth1) to the blogd server to handle raw data flow.
Typically eth1 uses a fixed IP address. This can be changed by running the “<b>hymod_netconf</b>”
utility on HYMOD, which allows DHCP and IP settings to be made to both Ethernet
ports; “reboot” HYMOD when done. Typically, eth0 uses DHCP (or relevant
beamline conventions) for connection to the beamline net. </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Kandinski uses a config file (/Hymod/apps/<b>kandinski-options</b>),
which typically has a single line, e.g.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-family:"Courier New"'>--config
kandinski_io25 –dam 384B5</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>which indicates the name of the executable (Kandinski_io25) and
the name of the Maia detector module (in this case 384 series B unit 5. In
later systems, the number is read from an ID chip in the DAM and should <u>not</u>
be set here, as in ...</p>

<p class=MsoNormal> </p>

<p class=MsoNormal><span style='font-family:"Courier New"'>--config
kandinski_io25 –dam 384D</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Kandinski should start on reboot. If not, Kandinski is
started with the command (as root):</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-family:"Courier New"'>appctl start
Kandinski_io25</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>and stopped using:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-family:"Courier New"'>appctl stop
kandinskl_io25</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The blogd daemon on the file server should be located and
run from the /etc/inet.d list. If you need to start it use (as root):</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-family:"Courier New"'>service csiro-blogd
start</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><i>Maia Control</i> on start-up will search the local users
home .geopixe dir (“~/.geopixe”) for any “*.Maia.conf” files, which can specify
the IP address and port for the Kandinski socket and the blogd daemon. The key
lines in this file are:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>             maia  ip  192.168.2.123                                     #
Kandinski socket</p>

<p class=MsoNormal>             maia  port   9001                                                 #
Kandinski port</p>

<p class=MsoNormal style='text-indent:29.45pt'>maia  name   Maia_123                                     #
a unique name stub for shared memory, etc.</p>

<p class=MsoNormal style='text-indent:29.45pt'>maia  enable   1                                                    #
enabled, else do not open port</p>

<p class=MsoNormal style='text-indent:29.45pt'>maia device   MAIA_DEVICE</p>

<p class=MsoNormal style='text-indent:29.45pt'>maia timeout   30.                                                #
timeout for background processes</p>

<p class=MsoNormal style='text-indent:29.45pt'>&nbsp;</p>

<p class=MsoNormal style='text-indent:29.45pt'>blog  ip  192.168.2.254                                      #
blogd file server IP</p>

<p class=MsoNormal style='text-indent:29.45pt'>blog  port   9000                                                  #
blogd port</p>

<p class=MsoNormal style='text-indent:29.45pt'>blog  enable   1                                                     #
enabled, else do not open the port</p>

<p class=MsoNormal style='margin-left:0cm'>&nbsp;</p>

<h2><a name="_Toc208917322">Preliminary Safe Operating Procedures</a></h2>

<p class=MsoNormal><span style='font-family:"Arial Italic"'>These notes provide
a quick start-up checklist. Use this only after becoming familiar with the
details of Maia internal workings and operation, as provided in the later
sections of this manual and the documents providing the technical description
of the detector system.</span></p>

<h3><a name="_Toc208917323">Cautions</a></h3>

<p class=MsoNormal style='margin-left:54.0pt;text-indent:-18.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Do
not touch the <b>beryllium</b> window on detector unit face, to avoid personal
toxic contamination, vacuum failure and detector damage. </p>

<p class=MsoNormal style='margin-left:54.0pt;text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Never
apply <b>Peltier</b> cooling current without cooling water flow. Never exceed 0.5
A (Maia 96) or 2.8 A (Maia 384B) or 1.7 A (Maia 384C, Maia 384D).</p>

<p class=MsoNormal style='margin-left:54.0pt;text-indent:-18.0pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Never
exceed a temperature of 65 °C on the DDM FPGA or MOSFET drive. Processor
warnings may appear in the syslog, and the red LED on the HYMOD front panel may
flash, if the board or CPU temperature exceeds a preset. </p>

<p class=MsoNormal style='margin-left:90.0pt;text-indent:-18.0pt'>a.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>A large pop-up warning will appear if temperatures exceed: 60 °C on the
detector (during baking), 40 °C water, 65 °C MOSFET, or 75 °C on the CPU or
FPGAs.</p>

<p class=MsoNormal style='margin-left:54.0pt;text-indent:-18.0pt'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Never
apply <b>Bias</b> without vacuum below 1.0e-5 mbar, and only change bias in 10V
intervals or less. For Maia 96 never exceed 75 V, and for Maia 384 never exceed
150 V. Later Maia 384 models have a maximum of 85-90 V.</p>

<p class=MsoNormal style='margin-left:54.0pt;text-indent:-18.0pt'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='background:yellow'>Never run the detector biased without a <b>valid
vacuum interlock</b></span>. </p>

<p class=MsoNormal style='margin-left:90.0pt;text-indent:-18.0pt'>a.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Test the interlock by observing its status during pump down. It should
show Fail (Red LED on Maia-Control panel) while the vacuum is above 10<sup>-5</sup>
mbar typically, and then become Good (Green LED on Maia-Control) only after the
vacuum has fallen into the 10<sup>-6</sup> mbar range.</p>

<p class=MsoNormal style='margin-left:54.0pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:54.0pt'><b><i><span style='font-size:
12.0pt;color:red'>This is extremely important! A vacuum failure with bias
applied will cause extreme damage to the detector, which cannot be repaired.</span></i></b></p>

<h3><a name="_Toc208917324">Emergency Shutdown</a></h3>

<p class=MsoNormal style='margin-left:54.0pt;text-indent:-18.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>In
the event of an emergency, power to the detector (power supply, computers,
cooling water, and vacuum pump) can be switched off (directly or as a result of
loss of local power) without harm to personnel or the equipment.</p>

<h3><a name="_Toc208917325">Detector Set-up</a></h3>

<p class=MsoNormal>The detector needs the following for safe operation: (i)
adequate vacuum, (ii) cooling water flow, (iii) connection to the control
processor via an optical link (orange cable). </p>

<h4>Vacuum</h4>

<p class=MsoNormal style='margin-left:53.45pt;text-indent:-18.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Vacuum
provided by an <b>oil-free</b> pumping system with base vacuum below 1.0e-5
mbar. A turbomolecular pump can be used for initial pump-down; once stable in
low 10<sup>-7</sup> mbar range, an ion pump may also be used in place of the
turbo.</p>

<p class=MsoNormal style='margin-left:89.45pt;text-indent:-18.0pt'>a.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>However, make sure a <b>valid interlock signal is prepared</b>, to
reflect good vacuum and water flow, and sent to the Maia power-supply interlock
connector.</p>

<p class=MsoNormal style='margin-left:53.45pt;text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>It
must have a <b>vacuum gauge</b> to measure vacuum in the manifold to be
connected to the detector. </p>

<h4>Cooling water</h4>

<p class=MsoNormal style='margin-left:53.45pt;text-indent:-18.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>The
detector is connected to a chiller to provide chilled water flow (-5 ºC to +10
ºC typically and to +20 ºC for conditioning) via flexible tubing to the ¼ inch
copper cooling tubes on the side of the detector housing.</p>

<p class=MsoNormal style='margin-left:53.45pt;text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Use
the supplied push-on connectors, which adapt from ¼” to 8 mm tubing. Be gentle
when connecting or removing these push-on connectors to avoid damage to Maia.</p>

<p class=MsoNormal style='margin-left:53.45pt;text-indent:-18.0pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>The
detector requires minimal water flow, monitored directly in the connecting
tubing. </p>

<p class=MsoNormal style='margin-left:53.45pt'>&nbsp;</p>

<p class=MsoNormal><b><i><span style='font-size:12.0pt;color:red'>Take extreme
care with cooling line connections, as these are fragile. Do not twist, push or
pull the cooling pipes where they enter the detector, as this may break
internal solder joints.</span></i></b></p>

<h4>Computer and ancillary connections</h4>

<p class=MsoNormal style='margin-left:53.45pt;text-indent:-18.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>A
low-voltage power-supply cable (thick blue cable) connects the detector housing
to the 19” rack form-factor power-supply unit.</p>

<p class=MsoNormal style='margin-left:53.45pt;text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>A
single 12-core optical cable (orange) connects the detector to the HYMOD
processing rack located outside the hutch.</p>

<h4>Maia detector indicator LEDs</h4>

<p class=MsoNormal><i>Status LEDs on the Maia detector housing (from top):</i></p>

<p class=MsoNormal style='margin-left:53.45pt;text-indent:-18.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Link
status</b> (green): optic fibre link to HYMOD is operational.</p>

<p class=MsoNormal style='margin-left:89.45pt;text-indent:-18.0pt'>a.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Flickering of this lamp, especially when manipulating the optic fibre
cable or connector itself (at either end), probably indicates poor alignment or
contamination of the plug in the optic fibre transceiver (socket).</p>

<p class=MsoNormal style='margin-left:53.45pt;text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Error</b>
(red): indicates failure of fibre optic link and other errors.</p>

<p class=MsoNormal style='margin-left:89.45pt;text-indent:-18.0pt'>a.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>A single blink indicates interlock down.</p>

<p class=MsoNormal style='margin-left:89.45pt;text-indent:-18.0pt'>b.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Two
blinks indicate an optic fibre transceiver problem. Typically, this is loss of
optical carrier, and in this case the green LINK LED will probably be
extinguished.</p>

<p class=MsoNormal style='margin-left:89.45pt;text-indent:-18.0pt'>c.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Three blinks indicate the Digital Analogue Module (DAM) power is
disabled manually, through setting Kandinskil variable ‘dam.power.enable’ to 0.</p>

<p class=MsoNormal style='margin-left:89.45pt;text-indent:-18.0pt'>d.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Four
blinks indicate the Digital Analogue Module (DAM) power is disabled because the
DAM's thermal cut-out has operated. The latter will occur if the detector
cooling water is not flowing. This condition latches, so will remain until
power to the entire detector subsystem is cycled at the detector power supply,
or remotely using the Kandinski variable ‘dam.power.enable’ (set to 0, then
back to 1).</p>

<p class=MsoNormal style='margin-left:53.45pt;text-indent:-18.0pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Poll</b>
(green): “heart beat” flashes at 1 Hz in the Kandinski program is running and
in control of the detector module.</p>

<p class=MsoNormal style='margin-left:53.45pt;text-indent:-18.0pt'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Refresh</b>
(green): flashes once with the Poll lamp when Kandinski refreshes the DDM after
initialisation, link loss, interlock trip, etc.</p>

<p class=MsoNormal style='margin-left:53.45pt;text-indent:-18.0pt'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Power</b>
(amber): indicates power on.</p>

<h3><a name="_Toc208917326">Detector Operation</a></h3>

<p class=MsoNormal><span style='font-family:"Arial Italic"'>These notes provide
a quick start-up checklist. Use this only after becoming familiar with the
details of Maia internal workings and operation, as provided in the later
sections of this manual and the documents providing the technical description
of the detector system.</span></p>

<h4>Cool down and applying bias</h4>

<p class=MsoNormal style='margin-left:53.45pt;text-indent:-18.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Start
the cooling water and the <i>Maia Control</i> program, if it is not running.</p>

<p class=MsoNormal style='margin-left:53.45pt;text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Open
the Maia<i> “</i>Rates” window (click on “Rates” on <i>Maia Control</i> “Maia
Detector System” main window) to monitor count rates. Select the “Detector Rate
Map” panel, which shows rate per detector element. Multiple copies of <i>Maia
Rates</i> can be opened to show different things.</p>

<p class=MsoNormal style='margin-left:53.45pt;text-indent:-18.0pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Open
the “ET Spectra” windows and click on “Full” to show all channels. Click on
“Select” to open the spectrum selection window. Click on “All” to display all E
spectra. Click on “Clear” in the main window periodically to clear all spectra.
(The “R” button can be used to display 32 channels at random across the array.)</p>

<p class=MsoNormal style='margin-left:53.45pt;text-indent:-18.0pt'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>After
vacuum has reached 1.0e-5 mbar, start the Peltier cooler. Overnight pumping or much
longer before cooling is recommended.</p>

<p class=MsoNormal style='margin-left:53.45pt;text-indent:-18.0pt'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Open
the “Setup” window by clicking on the “Maia” button under “Setup”. The detector
controls are on the “Controls” tab. Here you’ll find the detector Temperature
and Leakage read-back fields on the left under “Monitor”, and Peltier and Bias
controls under “Controls”. Increment the control sliders by clicking to the
right of the ‘handles’ to increase by 10 or use the arrows at the ends of the
slider to change by 5. Under Linux, click on the knob and use the arrows keys
on the keyboard, or simple type a desired target value in the box.</p>

<p class=MsoNormal style='margin-left:53.45pt;text-indent:-18.0pt'>6.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>The
bias should be set to a preset minimum of around 15 V. Once the detector
temperature has cooled to about 10 ºC above the water temperature, increment
the Peltier to 0.2 A (Maia 96) or 0.5 A (Maia 384) and increment the bias to 50
V.</p>

<p class=MsoNormal style='margin-left:53.45pt;text-indent:-18.0pt'>7.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Over
the course of the next hour, increment the Peltier up to 0.4 A (Maia 96) or 2.5
A (Maia 384B) or 1.0 A (Maia 384C, Maia 384D) and the bias up to 60 V (Maia 96)
or 70 V (Maia 384C,D or 100 V for 384B). At each step make sure the temperature
continues to fall (to around -15 ºC or lower) and that leakage remains less
than 5 µA. If the spectra show a large jump in counts that spread to high
energies, back off the bias by 5-10V.</p>

<p class=MsoNormal style='margin-left:53.45pt;text-indent:-18.0pt'>8.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>If
the detector has been in routine use, after 10-20 minutes the count rates in
all detectors should fall below a few counts per second (with no beam). Note
that a couple of channels may be disabled. A couple of channels may be ‘hot’;
these will need to be disabled if they do not recover as the system stabilises.
</p>

<p class=MsoNormal style='margin-left:53.45pt;text-indent:-18.0pt'>9.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>If
the detector has been off or vented, then it will take more time to settle, and
quite a few channels may still be noisy once cooled and up to 80 V bias (Maia
384C,D). Maia may require conditioning for some days. Please consult CSIRO for
guidance or assistance. After conditioning it should be ‘quiet’ with few noisy
pixels.</p>

<p class=MsoNormal style='margin-left:53.45pt;text-indent:-18.0pt'>10.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Finally, increment
to a working Peltier of 0.5 A (Maia 96) or 2.6-2.7 A (Maia 384B) or 1.0-1.1 A
(Maia 384C, Maia 384D) and bias of 75 V (Maia 96), 150 V (Maia 384B) and 80-85V
(Maia 384C, Maia 384D).</p>

<p class=MsoNormal style='margin-left:53.45pt;text-indent:-18.0pt'>11.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The detector is
ready for signal.</p>

<b><i><span style='font-size:12.0pt;font-family:"Arial",sans-serif;layout-grid-mode:
line'><br clear=all style='page-break-before:always'>
</span></i></b>

<h2><a name="_Toc208917327">Pulse capture in Maia</a></h2>

<p class=MsoNormal>Maia uses a 384 planar silicon detector array and dedicated
pulse processing application specific integrated circuits (ASICs), one channel
per detector. Pulses are amplified, shaped and sampled by the HERMES and
SCEPTER ASICs and digitized by synchronous ADCs. Data from the ADCs, along with
the associated detector address, are packaged and transmitted over a dedicated
optical link to the HYMOD processing sub-system.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:14.2pt'><img width=585 height=250
src="Maia-384-user-help_files/image004.png"></p>

<h3><a name="_Toc160002926"></a><a name="_Toc208917328">Detector Array</a></h3>

<p class=MsoNormal>The Maia sensor array comprises a 20 x 20 array of 1 x 1 mm<sup>2</sup>
Si planar diodes with a grid of 4 x 4 removed on the central axis for the beam.
The result is a 384 detector array. Connectivity to each detector pad is
provided by a 100 x 100 µm<sup>2</sup> aluminium bond pad deposited on top of
the larger implanted detector pad. Detector bond pads are wire-bonded to
dedicated pre-amplifier channels on the HERMES analogue pre-amplifier, shaping
ASICs.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The sensor array is cooled to -10 to -25 °C using Peltier
cooling elements mounted on a water-propylene-glycol cooled copper heat-sink
that also cools the front-end ASICs. In the case of the 384-element array, the
silicon extends about 8 mm beyond the active area in order to accommodate the
Peltier cooling elements. </p>

<h3><a name="_Toc208917329">HERMES Pre-amplifier, Shaper</a></h3>

<p class=MsoNormal>Each HERMES analogue signal conditioning ASIC provides 32
channels, each with a low-noise preamplifier, a high-order shaper and baseline
stabilizer. The 384 detector array uses 12 HERMES chips. The analogue
processing chain has an adjustable peaking time (0.5 µs, 1 µs, 2 µs, 4 µs), and
gain (750 mV/fC, 1500 mV/fC). Control parameters for HERMES include:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ech               HERMES
disable parameter ECH (ECH=1 to disable)</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>time              HERMES
peaking time (0=1.0, 1=0.5, 2=4.0, <b>3=2.0 µs</b>)</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>gain              HERMES
gain parameter (<b>0=1500 mV/fC</b> , 1=750 mV/fC)</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>eblk              HERMES
input bias leakage simulator (0=disabled)</p>

<h3><a name="_Toc208917330">SCEPTER Pulse Capture</a></h3>

<p class=MsoNormal>SCEPTER, provides readout of two analogue signals,
proportional respectively to the pulse-height and time-over-threshold (ToT). A
sample-and-hold and analogue FIFO action is used for both signals allowing
SCEPTER to multiplex the analogue levels to separate synchrotron ADC channels,
one for E and one for T. It can cope with up to 8 simultaneous events on the 32
input channels without event loss (when the <i>trk</i> and <i>trke</i> modes
are enabled). SCEPTER control parameters include:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>tdm              SCEPTER
timing mode (0=time-of-occurrence, 1=rise, 2=fall, <b>3=ToT</b>) </p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>tds                SCEPTER
TAC slope (0=64, 1=32, 2=16, 3=8, 4=4, 5=3, 6=2, 7=1 µs/V)</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>tos                SCEPTER
TAC timeout (0=64, 1=32, 2=16, 3=8, 4=4, 5=3, 6=2, 7=1 µs/V)</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>thresh           SCEPTER
threshold voltage (V)</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>clock            SCEPTER
and ADC read clock (MHz)</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>6.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>trk                 SCEPTER
simultaneous event catching (1=On)</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>7.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>trke               SCEPTER
enhanced simultaneous event catching (1=On)</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>8.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>trim              SCEPTER
individual channel threshold trim (V offset <u>below</u> thresh)</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>9.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>filt                 SCEPTER
optional input filtering (1=On)</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>10.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>tcm               SCEPTER
comparator multifire suppression (0=0ns, 1=100ns, 2=µs, 3=2µs)</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>11.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>thpd             SCEPTER
threshold adjust (V offset <u>below</u> thresh)</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The SCEPTER timing function (<i>tdm</i>) used in Maia is the
measurement of time-over-threshold (ToT) intended for pile-up rejection. For a
given pulse shape with no pile-up, a well defined relation between amplitude
and ToT exists. The Threshold is set by the parameter <i>Thresh</i>. Considering
the characteristic equation of a 5th order complex poles shaper and plotting
the ToT normalized to the peaking time versus the amplitude for a threshold
equal to 0.5V the curve below labelled “singles” is obtained [10]. The scale of
ToT is set by the time-to-analogue converter (TAC) slope parameter (<i>tds</i>).
TAC timeout (tos) should be set somewhat longer than <i>tds</i>.</p>

<p class=MsoNormal align=center style='text-align:center'><img width=446
height=353 src="Maia-384-user-help_files/image005.png"></p>

<p class=MsoCaption><a name="_Toc160002974">Time-over-threshold (ToT) as a
function of pulse amplitude without pile-up (“singles”) and with pile-up and
varying relative time between pulses (“piled-up”). ToT enables pile-up to be
discriminated.</a></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The relation between ToT and amplitude in pile-up events is
also shown, considering two pulses of equal amplitude with an increasing
relative delay. When the delay is negligible (A) the two pulses sum and the
resulting signal cannot be distinguished from a single pulse of twice the
amplitude. Increasing the delay the amplitude of the resulting signal decreases
and the ToT increases until the shape presents a double peak (B). Further
increase in the delay results in a constant peak amplitude (SCEPTER acquires
the first peak) and in an increased ToT (C). The signal path allows one to
distinguish, inside the biparametric scatter plot plane ToT vs. Peak Amplitude,
the regions associated to single pulses from those associated to pile-up
events. Thus, it allows discrimination against pile-up. </p>

<h3><a name="_Toc208917331">ADCs</a></h3>

<p class=MsoNormal>SCEPTER chips have tri-state outputs allowing several to be
ganged together for input into a single pair of dedicated synchrotron ADCs. In
the 384 detector, 3 SCEPTERs share a pair of ADCs, one for E and one for T. The
ADCs reads the output E and T at a fixed rate set by the SCEPTER clock
parameter. If data is present on the read, it is passed by the DDM over the
optical link to the HYMOD processing pipeline. </p>

<p class=MsoNormal>&nbsp;</p>

<h2><a name="_Toc208917332">Data processing Pipeline</a></h2>

<p class=MsoNormal>Real-time correction of detected signal data, pile-up
rejection and image accumulation are done in the HYMOD processor FPGA code,
written using the CSIRO developed 3PL language. Data is advanced through the
pipeline on each clock cycle (approx. 50 MHz); HYMOD is able to accept new data
events at this rate. </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:0cm'><img width=601 height=466
src="Maia-384-user-help_files/image006.jpg"></p>

<p class=MsoNormal style='margin-left:0cm'><i>Data flow through the real-time
HYMOD processor. Events are corrected in real-time in the first few modules and
then collected in various accumulators and output when triggered on pixel
advance, timer trigger, etc. The readout record contains the accumulator data
as well as a number of common variables, such as counter values (used for ion
chamber counters), dead-time data and encoder values (XYZ, etc.).</i></p>

<h3><a name="_Toc208917333">Event correction</a> </h3>

<p class=MsoNormal>The main data flow (yellow boxes) is through modules for
data correction and filtering and then buffered for output as ET events (data
words that encode E, T and detector number n within a single 32 bit word):</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Linearization</b>:
Used to use a lookup table to correct for a small degree of non-linearity in
Maia response with energy. Now it implements a polynomial correction. It also
implements anti-aliasing for this and the gain-trim module.</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Gain
trim</b>: Uses a linear mapping (2 coefficients per channel for each of E and
T) to match all E detector channels to the same calibration; same for all T
channels. The result is that all E and T channels should have peaks in the same
position as the first active channel.</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Member
of Groups</b>: Flags if the current event is a member of up to 16 groups.
Groups are defined to select detectors for the following accumulators:</p>

<p class=MsoNormal style='margin-left:96.55pt;text-indent:-18.0pt'>a.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><b>0-11</b>: Up to 12 spectra histogram accumulators (4 spectra in
initial implementation)</p>

<p class=MsoNormal style='margin-left:96.55pt;text-indent:-18.0pt'>b.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>12</b>:
A<a name="OLE_LINK3"></a><a name="OLE_LINK4">ctivity </a>accumulator</p>

<p class=MsoNormal style='margin-left:96.55pt;text-indent:-18.0pt'>c.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><b>13</b>: ET event buffer.</p>

<p class=MsoNormal style='margin-left:96.55pt;text-indent:-18.0pt'>d.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>14</b>:
Dynamic Analysis (DA) accumulator (also implements ROI in the current version)</p>

<p class=MsoNormal style='margin-left:96.55pt;text-indent:-18.0pt'>e.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><b>15</b>: Dead-time statistics accumulator</p>

<p class=MsoNormal style='margin-left:60.55pt'>Each group has a 384 bit field
to enable any combination of detectors for the group. Groups can be defined
arbitrarily, for example based on ASIC number, radial distance from axis, etc.
This is discussed later in the <i>Maia Control</i> GUI notes.</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Pileup
rejection</b>: Tests whether the T value of the current event falls outside the
T bounds set for the current E. If so, the pileup bit on that event is set. The
pileup table is a lookup table of lower and upper T limits for each E. Group
definitions specify whether a group will reject events if the pileup bit is
set. Typically, the DA accumulator will reject pileup (so we avoid pileup
artefacts in images) and the ET accumulator will not (so we log all events for
later re-processing, including a new pileup rejection field if necessary).
Spectra groups may reject pileup or not, to be able to contrast pileup effects.</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Throttle
sub-sampling</b>: All events for certain intense spectral features do not need
to be saved to disk. The “Throttle” mechanism defines a modulo counter for
selected channels so that only the n’th event in these channels is logged to
disk. The modulo counter is incremented for each event based on E, and the
Throttle bit on that event is reset only when the counter wraps around at the
desired modulo count. Throttle settings are also set-up through the Group
definitions. The Throttle modulo factors are 4 bit, restricted in the range
1-15 for now.</p>

<h3><a name="_Toc208917334">ET event buffering</a></h3>

<p class=MsoNormal>The main data flow (yellow boxes) finishes with buffering of
ET events for output (data words that encode E, T and detector number n within
a single 32 bit word):</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>ET
event accumulator</b>: Buffers selected ET event words (those that pass the
pileup and throttle tests, if these modes are enabled for ET group 13) in the
HYMOD output buffer. When full, it is written to the <i>blogd</i> server and
written to disk. They are also available for clients to <i>blogd</i>, such as
the<i> Maia Control</i> GUI. The ET event accumulator, like all accumulators,
can accept or reject events based on their group, pileup or throttle bits. In
parallel, it accumulates counts from the two flux inputs.</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>ET
event readout</b>: When the buffer is full, or after a timeout to ensure that
data is kept in HYMOD for a limited time, the buffer is written over the
network to the <i>blogd</i> server and logged to disk (if logging is enabled).
A header is added during readout, containing a time-stamp and other details of
the record, such as a unique sequence counter. Accumulators are
double-buffered, and so during readout no events are lost.</p>

<h3><a name="_Toc208917335">DA and ROI imaging</a></h3>

<p class=MsoNormal>The DA extension to the data-flow (green boxes) is intended
for real-time imaging using the DA method or simple ROI and has these
processing modules. ROIs are handled as a trivial sub-class of DA. The DA
accumulator uses Group 14.</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Calculate
energy</b>: The energy of each event (after linearization and gain-trimming) is
determined from E using a lookup table of individual linear energy calibrations
for each detector channel.</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>DA
Matrix Column</b>: The column of the DA matrix is calculated using the energy
calibration associated with the DA matrix. The column contains the increments
to make to each element at the current pixel address.</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>DA
Accumulator</b>: The increments are accumulated in an array of accumulators,
one for each element.</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>DA
readout</b>: On readout trigger, which is generated on pixel advance when the
encoder show that the stage has moved into the next pixel address, the DA
accumulators are read out and cleared. The output record is tagged with dwell
time in the pixel, pixel XYZ… address and the flux counter 0 and 1 values. Accumulators
are double-buffered, and so during readout no events are lost.</p>

<h3><a name="_Toc208917336">ET Spectra</a></h3>

<p class=MsoNormal>Diagnostic spectra are extracted from ET events into one E
and one T spectrum per channel. This is done in a <i>Maia Control</i>
background process, which may not keep up with data rates. Hence, these spectra
will not contain all events, but enable examination of every detector channel
during data acquisition.</p>

<h3><a name="_Toc208917337">Group Spectra</a></h3>

<p class=MsoNormal>Diagnostic spectra can also be accumulated in real-time
using a number of spectra accumulators in Maia. These make use of the
flexibility of “Groups” to accumulate any combination of detector channels,
with or without pileup rejection or Throttling. Spectra accumulators can
operate up to the full count rates of Maia (&gt;50 M/s).</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Accumulate
spectra</b>: If the event satisfies the Group mask for a spectrum accumulator,
and the pileup and throttle settings, it is added into the spectrum.</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Spectra
readout</b>: On readout trigger, which is commonly generated on a timer
trigger, the Spectra accumulators are read out and cleared. Accumulators are
double-buffered, and so during readout no events are lost.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><i>This feature has not been completely implemented. As a
result, only the first group spectrum #0 is working properly. It provides a
simple way to obtain a single spectrum for all channels (mapped into a single
energy calibration).</i></p>

<h3><a name="_Toc208917338">Energy-Time Histogram</a></h3>

<p class=MsoNormal>A 2D histogram (256 x 128) that shows E-T relationships is
accumulated in the ET 2D accumulator as Group 12. </p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>ET
2D accumulator</b>: If the event satisfies the Group mask for the ET 2D
accumulator, and the pileup and throttle settings, it is scaled and added into
the 2D histogram.</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>ET
2D readout</b>: On readout trigger, which is commonly generated on a timer
trigger, the ET 2D accumulator is read out and cleared. Accumulators are
double-buffered, and so during readout no events are lost.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><i>The 2D ET histogram accumulator is not used at present; a
2D ET display is emulated using extraction from the ET event stream by a Maia
Control process. Hence, the 2D ET display will not contain all events, but
enable examination of the trend during data acquisition.</i></p>

<h3><a name="_Toc208917339">Activity</a></h3>

<p class=MsoNormal>Arrays that track count rates by detector channel and Group
are accumulated in the Activity accumulator (no Group, pileup or throttle
filters). </p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Activity
accumulator</b>: increments registers based on detector channel and Group ID,
for all groups that the event may be part of.</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Activity
readout</b>: On readout trigger, which is commonly generated on a timer
trigger, the ET 2D accumulator is read out and cleared. Accumulators are
double-buffered, and so during readout no events are lost.</p>

<p class=MsoNormal style='margin-left:0cm'>&nbsp;</p>

<h2><a name="_Toc208917340">Maia Control User Interface</a></h2>

<p class=MsoNormal>The <i>Maia Control</i> GUI is started on a Windows PC or
beamline Linux workstation to monitor and control the detector. It uses a <b>configuration
file “…Maia.conf” located in a user’s home .geopixe directory</b> (if multiple
files are available, you will be presented with a file selector). The conf file
contains the IP addresses of the HYMOD processor, which is needed to connect to
the <i>Kandinski</i> socket, and the blog server, which is needed to connect as
a client to the <i>blogd</i> server.  Lines can be commented out using the “#”
character.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><i>NOTE: Initially, if no Maia.conf file is found, a
template will be copied to your home .geopixe directory. Edit this for your
system configuration.</i></p>

<p class=MsoNormal style='margin-left:0cm'>&nbsp;</p>

<p class=MsoNormal>The left of the window has a panel of status LEDs that
indicate the status of:</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Maia
socket</b>: Indicates whether <i>Maia Control</i> managed to connect to a
running <i>Kandinski</i> (green). Red indicates a failed connection, or that <i>Kandinski</i>
is not running.</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>DDM
link</b>: Indicates a functioning optical link between the DDM unit in the
detector head and the HYMOD crate (green).</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Maia
to Blog</b>: Indicates that <i>Kandinski</i> has successfully opened a
connection to <i>blogd</i> (green) for data logging on the file server.</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Blog
clients</b>: Indicates that<i> Maia Control</i> has opened its background
processes (green) connected to <i>blogd</i> as clients for read-back of event
records.</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Interlock</b>:
Indicates that Maia hardware interlocks are OK (green).</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'><b>6.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></b><b>Bakeout</b>:
Indicates (red) that the Bakeout plug is connected and the Peltier controls can
be used to either Cool or Bake the detector – selected via the COOL/BAKE
droplist. Do not heat the array beyond ~50 °C. Also ensure that no other
temperatures (e.g. Hermes, MOSFET, FPGA) exceed 65 °C.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The central part of the window has a group of fields:</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Maia,
Reset, ET spectra, ET 2D, rates, Groups, Image, Multi, Browse buttons</b>:
These open various windows as indicated below under <i>Maia Control Windows</i>.</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Text
display field for (i) context-sensitive help (just move the cursor over a
widget to get help on it), and (ii) updates of detector bias, temperature and
leakage current. </p>

<p class=MsoNormal><b>&nbsp;</b></p>

<p class=MsoNormal>The right of the window has a group of Control buttons and
status:</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Newrun/
Endrun button</b>: “Newrun” can start data collection and logging to a new blog
run (normally this is done via Epics/Tango). The button changes to “Endrun”
when it is running, which can be used to manually stop data collection. This
can be used during set-up and testing. A Newrun increments the run number.</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Clear</b>:
Clears shared memory buffers for ET spectra and DA real-time images. This does <u>not
clear data</u> stored in the blog data files.</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Run,
Rate, Project/Group</b>: shows the status of the blog run number, data rate to
disk and the “Project”, which is the parent directory for blog data logging,
and “Group”, which is a user selectable sub-dir for grouping data as collected.
It also shows an estimate of free disk space. Click on this row to set a Group.
It is better to do this via beamline GUI controls.</p>

<p class=MsoNormal style='margin-left:0cm'>&nbsp;</p>

<p class=MsoNormal style='margin-left:36.0pt'><img width=604 height=137
src="Maia-384-user-help_files/image007.jpg"></p>

<p class=MsoNormal style='margin-left:36.0pt'><i>Maia Control GUI showing
version number and Kandinski version, which is running on the Maia coprocessor.</i></p>

<h3><a name="_Toc208917341">Maia Control Windows</a></h3>

<p class=MsoNormal>The main control panel has launch buttons for all main
functions. Notes on each can be viewed in the help box by passing the cursor
over each.</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Maia:</b>
Opens the<i> Maia Setup</i> window, which is used to set-up and view Maia
parameters and control cooling and bias (see section below).</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Reset:</b>
Resets some hardware settings and background processes reading event records,
etc. Also rewrites parameters to the detector head.</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>ET
Spectra:</b> Opens 2 <i>Spectrum Display</i> windows, one for E spectra and one
for T spectra. Use the “Select” button to open <i>Spectrum Select</i> windows
to control detector selection and colours (see the <i>GeoPIXE</i> manual for
details). These spectra are built up from ET event records obtained from <i>blogd</i>.
At very high rates, some blocks may be lost (lost block rates can be checked in
the Rates window).</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><img width=605 height=377
src="Maia-384-user-help_files/image008.png"></p>

<p class=MsoNormal><i>The “ET Spectra” button opens 2 windows, one for E
spectra and one for T. This figure shows all 384 E spectra in “Highlight” mode
with detector 92 selected (green), selected using the Select window</i></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Groups</b>:
Opens another <i>Spectrum Display</i> window, which displays the spectra
collected in real-time in HYMOD, which reflect the Groups detector selections
for the first few Groups. These do not suffer from lost blocks at any count
rate up to the maximum (&gt;50 M/s).</p>

<p class=MsoNormal style='margin-left:0cm'>&nbsp;</p>

<p class=MsoNormal style='margin-left:60.55pt'><i>Groups spectra display, which
shows the real-time spectra accumulated in HYMOD, specified as the first few
Groups. Most controls behave as in GeoPIXE. See the GeoPIXE manual for details
of the Spectrum Display window. Click on “Select” to select spectra to display
using the Spectrum Select window (see GeoPIXE manual).</i></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Image</b>:
Opens a GeoPIXE Image window to display real-time DA (or ROI) images. The <i>Image</i>
window is pretty high on resources due to the functionality that it provides. </p>

<p class=MsoNormal style='margin-left:60.55pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:60.55pt'><i>It is best to not open too
many on 32-bit systems, especially for high-definition Maia images. Use the
Multi-Image display window instead for multiple images. Similarly, avoid
zooming in by clicking on “+” more than about once. An RGB Image window can
also be opened to monitor real-time imagery by using the Windows menu on the
Image window</i>.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><img width=446 height=539
src="Maia-384-user-help_files/image009.png"></p>

<p class=MsoNormal><i>Image window display, used to display real-time DA (or
ROI) images. See GeoPIXE manual for details.</i></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>6.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Multi</b>:
Opens a single window that enables the display of up to 25 element images from
DA or ROI real-time acquisition in HYMOD. Left-click and drag out a selection
rectangle in the <b>top left window</b> to zoom in all other windows. Right
click (top left) to clear the zoom region.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><img width=604 height=651 id="Picture 3"
src="Maia-384-user-help_files/image010.jpg" alt=13099-realtime-multi.png></p>

<p class=MsoNormal><i>Multi-image display showing a 9 image selection. Change
image number using the buttons on the left, and change image size by resizing
the window. Each element window has a sub-set of GeoPIXE Image window controls
for minimum and maximum concentration display, Z axis scale (linear, Sqrt, Log)
and element selection drop-lists.</i></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>7.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Rates</b>:
Opens a window with three panels to display count rates and process resource
usage:</p>

<p class=MsoNormal style='margin-left:96.55pt;text-indent:-18.0pt'>a.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><b>Count rates</b>: Shows a histogram of count rates by detector number
within a selected quadrant, HERMES chip or the whole detector.</p>

<p class=MsoNormal style='margin-left:96.55pt;text-indent:-18.0pt'>b.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Detector
rate map</b>: Displays count rate as a colour-map overlaid on a mimic display
of the detector array. </p>

<p class=MsoNormal style='margin-left:96.55pt;text-indent:-18.0pt'>c.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><b>Process load</b>: Shows a histogram of process % CPU busy and % lost
buffer estimates.</p>

<p class=MsoNormal><b>&nbsp;</b></p>

<p class=MsoNormal style='margin-left:63.8pt'><span style='layout-grid-mode:
both'><img width=454 height=442 src="Maia-384-user-help_files/image011.png"></span></p>

<p class=MsoNormal style='margin-left:63.8pt'><i>Maia detector count rate map
for the 384 detector array. Also displays total count rates and flux counter
rates. Pass the cursor over detector pads to view the detector number and view
updating count rates for that pad in the text fields. Click on a pad to switch
E and T spectra display to this pad.</i></p>

<p class=MsoNormal style='margin-left:63.8pt'><i>&nbsp;</i></p>

<p class=MsoNormal style='margin-left:63.8pt'><span style='layout-grid-mode:
both'><img width=455 height=440 src="Maia-384-user-help_files/image012.png"></span></p>

<p class=MsoNormal style='margin-left:63.8pt'><i>Maia detector count rate
histogram, with “All” detector channels selected. The Red histogram shows the
maximum rates obtained per channel. Use “Clear” to reset the maximum rate
display.</i></p>

<p class=MsoNormal style='margin-left:63.8pt'><i>&nbsp;</i></p>

<p class=MsoNormal style='margin-left:63.8pt'><i><img width=459 height=446
src="Maia-384-user-help_files/image013.png"></i></p>

<p class=MsoNormal style='margin-left:63.8pt'><i>Maia detector rate display
under the “Process” tab, which shows estimates of processor load and missed
buffer rates. This display shows the high processor load when all 384 E spectra
are selected (as shown above). Select fewer spectra for lower processor load.</i></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>8.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>ET
2D</b>: Opens a window to display the Energy-Time histogram, collected in
real-time in HYMOD, as a 2D histogram colour map. Adjust the minimum and
maximum histogram levels using the two sliders. Zoom into a region with a
left-click and drag manoeuvre to select a rectangular zoom region. Right click
to reset this.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='layout-grid-mode:both'><img width=582
height=469 src="Maia-384-user-help_files/image014.png"></span></p>

<p class=MsoNormal><i>ET 2D histogram showing all or a selected detector
channel(s) logged in ET event (select channels using the droplist). This shows
E versus T after gain-trimming to match E and T spectra gains and offsets so
they follow a single trend</i></p>

<p class=MsoNormal style='margin-left:85.1pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>9.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Browse</b>:
Opens a window like <i>BlogBrowser</i> to sample the event stream (not all
events of a selected type will necessarily be captured). </p>

<p class=MsoNormal style='margin-left:96.55pt;text-indent:-18.0pt'>a.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Click on “Start” to start adding selected events to the list view,
“Stop” top stop and “Clear” to clear the list. Up to 300 records are added. </p>

<p class=MsoNormal style='margin-left:96.55pt;text-indent:-18.0pt'>b.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Click
on “Select Record Tags” to open a window to select which Blog records to
display. </p>

<p class=MsoNormal style='margin-left:96.55pt;text-indent:-18.0pt'>c.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Click on records to see more information or pop-up plots.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><img width=604 height=378
src="Maia-384-user-help_files/image015.png"></p>

<p class=MsoNormal><i>BlogBrower window for real-time sampling of the event
stream. Not all selected event types can be displayed; only a sub-sampling is
provided for very high-volume record types, such as the main ET event records.</i></p>

<p class=MsoNormal><i>&nbsp;</i></p>

<p class=MsoNormal><span style='layout-grid-mode:both'><img width=608
height=333 src="Maia-384-user-help_files/image016.png"></span></p>

<p class=MsoNormal><i><span style='layout-grid-mode:both'>Detector rates from
an ET event</span></i></p>

<p class=MsoNormal><span style='layout-grid-mode:both'>&nbsp;</span></p>

<p class=MsoNormal><span style='layout-grid-mode:both'><img width=604
height=370 src="Maia-384-user-help_files/image017.jpg"></span></p>

<p class=MsoNormal><i><span style='layout-grid-mode:both'>E-T plot for a
selected ET record</span></i></p>

<p class=MsoNormal><i>&nbsp;</i></p>

<p class=MsoNormal><span style='layout-grid-mode:both'><img width=604
height=320 src="Maia-384-user-help_files/image018.jpg"></span></p>

<p class=MsoNormal><i><span style='layout-grid-mode:both'>Dead-time rate from a
DT record</span></i></p>

<p class=MsoNormal><i>&nbsp;</i></p>

<p class=MsoNormal><span style='layout-grid-mode:both'><img width=605
height=325 src="Maia-384-user-help_files/image019.jpg"></span></p>

<p class=MsoNormal><i><span style='layout-grid-mode:both'>DT record showing
pile-up losses for a time period</span></i></p>

<p class=MsoNormal style='margin-left:85.1pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:60.55pt;text-indent:-18.0pt'>10.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><b>Chart</b>:
Opens the <i>Chart</i> window to display logged detector parameters versus
time. This is disabled by default. Enable it from the Setup “Enable” tab. Use
the Select button to open <i>a Spectrum Select</i> window to control which
parameters are plotted (and see colour legend). Parameters are logged versus
time (UTC time relative to Jan 1, 1970) to the file “Maia_384xx_log.csv” (set
via …Maia.conf file).</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><img width=604 height=445
src="Maia-384-user-help_files/image020.jpg"></p>

<p class=MsoNormal><i>Maia Chart display showing selected parameters as a
function of time, sampled every few seconds. The colour legend is provided by
the 2<sup>nd</sup> column of the Spectrum Select window for parameters selected
for display.</i></p>

<p class=MsoNormal>&nbsp;</p>

<h2><a name="_Toc208917342">Maia Detector Setup window</a></h2>

<p class=MsoNormal>The purpose of the <i>Maia Setup</i> window is to set-up the
real-time processing pipeline for routine data collection. In its raw state,
spectra from each detector will have different gain and offset and a small
non-linearity. These need to be characterized to set-up lookup tables and
linear mappings to correct this before routine analysis. It is expected that
these tables for (i) Linearization, (ii) gain-trimming, and (iii) pile-up
rejection will be set-up and enabled for routine analysis.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Maia parameters are set-up and viewed using this window,
which is divided into 3 areas: (i) the left panel has a series of tabs to
select groups of Maia parameters and panels for detector control and debugging;
(ii) the right panel normally shows a mimic display of the detector that is
used to select detector pads for selective application of parameters or to
display parameters across the array. It also has tabs on the right to switch
the display to diagrams showing detector layout, data-flow organization and
system layout; and (iii) the bottom strip, which has Save and Load buttons for
global parameters and controls for the mimic display. Normally, the mimic
display is used to select groups of detectors for application of parameters or
to set up Groups, for example. The grouping of detector pads for selection is
controlled using the “Selection Class” droplist. It can also be used to display
parameters across the array as a colour map (by enabling “Show Parameters”).</p>

<h3><a name="_Toc208917343">Enable</a></h3>

<p class=MsoNormal>This panel is used to (i) disable detector channels that are
not functioning correctly (top box; used with mimic display), (ii) enable Maia
readout by quadrant and clock phase (used to select SCEPTERs within a quadrant;
middle box), and (iii) enable various phases of the real-time processing
pipeline (lower box); details of the pipeline are set-up elsewhere (HYMOD,
Groups and Imaging tabs).</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><img width=603 height=432
src="Maia-384-user-help_files/image021.jpg"></p>

<p class=MsoNormal><i>Maia Detector Setup window showing the first tab panel
for enabling and disabling detector channels. The right panel shows the mimic
display and the disabled detector channels. The tabs at the right can be used
to show the system layout and processing pipeline diagrams as shown in the
Overview above.</i></p>

<p class=MsoNormal style='margin-left:85.1pt'>&nbsp;</p>

<p class=MsoNormal>If spectrum quality indicates a bad detector channel, or the
count rate of one channel indicates a lot of noise (see <i>Rates</i> window
elsewhere), then those channels can be disabled here. The mimic display shows
the channels disabled currently (shown in violet; actually, on entry to the
“Enable” panel). To update this display, press “Read”. Set the selection class
to “individual”. Toggle channels to disable/enable them on the mimic display.,
and then “Apply to HERMES”. This sets the HERMES ASIC disable parameter (ECH).
All HERMES and SCEPTER parameters can be viewed in the table on the Summary
tab. Also, these selections can be Loaded from or Saved to a file.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The lower boxes of the Enable tab panel are immediate, i.e.
they send settings instantly to Maia via Kandinski. Most other panels (and the
Disable function above) have explicit “Apply” buttons to send data to Maia.
These enable check-boxes are short-hands for switching this pipeline modules on
and off. The “Auto Save DA Images” check-box enables the saving of the
real-time DA images to disk after each run. Remember to set up the parameters
on the HYMOD, Groups and Imaging tabs first. </p>

<h3><a name="_Toc208917344">HERMES</a></h3>

<p class=MsoNormal>This panel is used to set parameters for the HERMES pre-amp,
quasi-Gaussian pulse shaper ASICs. Most parameters are set at the chip level,
and so the “Selection Class” is set to “Chip”. Click on any detector pad within
a desired Chip to toggle the selection, or normally set the selection class to
“All” to set all HERMES chips. Now set the check box to the left of the
parameter group you wish to change and set the new value from the droplists and
sliders. On “Apply to HERMES” this change is sent to the selected HERMES chips.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='layout-grid-mode:both'><img width=604
height=440 src="Maia-384-user-help_files/image022.jpg"></span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The check-boxes also double as a way to display parameters
as a colour map across the array. Set the toggle below the mimic display to
“Show Parameters”. Now check a desired parameter on this panel (or the SCEPTER
or Summary tabs), using the small checkbox on the right of each, to see how
it’s set across all chips.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>HERMES, along with SCEPTER and HYMOD parameters, are saved
to disk using the “Save Maia Parameters” button at the bottom of the window.
The exception is the Disable (ECH) parameters, which are saved separately on
the Enable tab panel.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>In “Show Parameters” mode, click on the small check-box to
the right of an item to display its values across the mimic display of the Maia
array.</p>

<h3><a name="_Toc208917345">SCEPTER</a></h3>

<p class=MsoNormal>This panel is used to set parameters for the SCEPTER
pulse-capture, sample and hold and derandomizer ASICs. Most parameters are set
at the chip level, and so the “Selection Class” is set to “Chip”. Click on any
detector pad within a desired Chip to toggle the selection, or normally set the
selection class to “All” to set all SCEPTER chips. Now set the check box to the
left of the parameter group you wish to change and set the new value from the
droplists and sliders. On “Apply to SCEPTER” this change is sent to the
selected SCEPTER chips.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The <b>Threshold</b> parameters provide a chip-by-chip
adjustment to Threshold. These can bet set in two ways: (i) select chips and
set a value in the slider for the Threshold, or (ii) use the Up and Down arrows
to shift the Threshold values of selected chips by +0.005V or -0.005V,
respectively. These maintain differences between Threshold values on each chip
and increment/decrement them together. Then apply this value to all selected
channels.</p>

<p class=MsoNormal style='margin-left:0cm'>&nbsp;</p>

<p class=MsoNormal><span style='layout-grid-mode:both'><img width=605
height=439 src="Maia-384-user-help_files/image023.jpg"></span></p>

<p class=MsoNormal style='margin-left:0cm'>&nbsp;</p>

<p class=MsoNormal>The <b>Trim</b> parameters provide a channel-by-channel
adjustment, which is combined with Threshold (actually subtracted from it).
These can bet set in two ways: (i) select channels and set a value in the
slider for the Trim, or (ii) use the Up and Down arrows to shift the Trim
values by +0.005V or -0.005V, respectively. These maintain differences between
Trim values across channels and increment/decrement them together. Remember to
“Apply to SCEPTER” these changes to selected channels. </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='layout-grid-mode:both'><img width=605
height=439 src="Maia-384-user-help_files/image024.jpg"></span></p>

<p class=MsoNormal style='margin-left:0cm'>&nbsp;</p>

<p class=MsoNormal>HERMES, along with SCEPTER and HYMOD parameters, are saved
to disk using the “Save Maia Parameters” button at the bottom of the window.
The exception is the Disable (ECH) parameters, which are saved separately on
the Enable tab panel.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The check-boxes on the right also double as a way to display
parameters as a colour map across the array. Set the toggle below the mimic
display to “Show Parameters”. Now check a desired parameter on this panel (or
the HERMES or Summary tabs, etc.) to see how it’s set across all chips.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='layout-grid-mode:both'><img width=605
height=390 src="Maia-384-user-help_files/image025.jpg"></span></p>

<p class=MsoNormal><i><span style='layout-grid-mode:both'>“Show Parameters”
with “Overall Threshold-Trim” selected</span></i></p>

<h3><a name="_Toc208917346">HYMOD</a></h3>

<p class=MsoNormal>Parameters and lookup tables for the real-time processing
pipeline in HYMOD are constructed elsewhere (e.g. using tools in Spectra and
Image windows, here or in GeoPIXE, using GeoPIXE procedures – see section “Maia Pipeline Set-up” p.37). In the HYMOD tab panel, these lookup table files are
loaded and enabled/disabled. To send lookup table and enable settings to HYMOD,
click on “Apply to HYMOD”.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><img width=604 height=387
src="Maia-384-user-help_files/image026.jpg"></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Most HYMOD tables and pipeline settings apply to all data
collected by HYMOD. Linearization, gain-trimming, pile-up rejection, dead-time
and energy calibration apply to all experiments. </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>In contrast, Throttle settings and lookup table are very
specific to a sample, its major element lines and intensities, and to the beam
energy, and its scatter peaks. These are not set globally, using the “Save Maia
Parameters” and “Load and Apply Maia Parameters”. Set and enable these manually
here, if needed to reduce data rates to disk for this experiment.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><i>TIP: Once Throttle settings are established here, they
can be turned on and off on the “Enable” tab.</i></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The up, down “Adjust Offsets” arrow buttons in the Gain-trim
group can be used to adjust the T Gain-trim offsets by +10, -10, respectively.
These can be used to move the E-T field (in T direction) for selected
individual channels into the correct position within the Pileup field (e.g.
after a change of Trim). Click on “Apply to HYMOD” next these arrows to apply
these changes to HYMOD. </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><i>TIP: To only see detector channels that you wish to
adjust using the T Gain-trim arrow buttons, select these channels in the ET2D
window using the droplist on the left.</i></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>After data has been Applied to HYMOD, the mimic display will
show the channels that have been included. Click on “Set Disables” to disable
those channels that have NOT been selected. During energy calibration
procedures, delete any spectra not wanted. Hence, the loaded energy calibration
SPEC file should only contain good channels.</p>

<h3><a name="_Toc208917347">Summary</a></h3>

<p class=MsoNormal>The Summary tab displays a table of HERMES and SCEPTER
parameters. It also contains columns for energy calibration and gain trimming
parameters as well as array layout parameters for effective pad width and
height, and layout indices for each pad based on Chip, Quadrant, Column and Row
in the array. Click on a column heading to sort the table based on this column
in ascending order.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The first column “Indx” is the index of the pad in the
layout CSV file. For the 384 detector array, this index runs from top left
across rows in the array and in rows from top to bottom. The next column “Det”
is the detector channel number. The columns are:</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Indx             CSV
detector layout table index</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Det               detector
channel or pad number</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ech               HERMES
disable parameter ECH (ECH=1 to disable)</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>time              HERMES
peaking time (0=1.0, 1=0.5, 2=4.0, 3=2.0 µs)</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>gain              HERMES
gain parameter (0=1500 mV/fC , 1=750 mV/fC)</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'><a
name="OLE_LINK7"></a><a name="OLE_LINK8">6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>tdm              SCEPTER timing mode (0=time-of-occurrence, 1=rise,
2=fall, 3=ToT) </a></p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>7.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>tds                SCEPTER
TAC slope (0=64, 1=32, 2=16, 3=8, 4=4, 5=3, 6=2, 7=1 µs/V)</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>8.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>tos                SCEPTER
TAC timeout (0=64, 1=32, 2=16, 3=8, 4=4, 5=3, 6=2, 7=1 µs/V)</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>9.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>thresh           SCEPTER
threshold voltage (V)</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>10.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>thpd             SCEPTER
threshold adjust (V offset <u>below</u> thresh)</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>11.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>trim              SCEPTER
individual channel threshold trim (V offset <u>below</u> thresh)</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>12.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>clock            SCEPTER
and ADC read clock (MHz)</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>13.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>eblk              HERMES
input bias leakage simulator (0=disabled)</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>14.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>tcm               SCEPTER
comparator multifire suppression (0=0ns, 1=100ns, 2=µs, 3=2µs)</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>15.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>filt                 SCEPTER
optional input filtering (1=On)</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>16.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>trk                 SCEPTER
simultaneous event catching (1=On)</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>17.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>trke               SCEPTER
enhanced simultaneous event catching (1=On)</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>18.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>CalA            energy
calibration gain (keV/bin)</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>19.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>CalB            energy
calibration offset (keV)</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>20.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>TrimEa        gain
trimming gain for E</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>21.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>TrimEb        gain
trimming offset for E</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>22.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>TrimTa        gain
trimming gain for T</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>23.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>TrimTb        gain
trimming offset for T</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>24.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>X                   X
coordinate of pad centre (detector geometry comes from .csv file)</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>25.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Y                   Y
coordinate of pad centre</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>26.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Width           effective
width of detector pad (after masking)</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>27.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Height          effective
height of detector pad (after masking)</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>28.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Tilt                tilt
(degrees) of pad from planar (towards array centre)</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>29.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>FWHM        FWHM
of channel (eV) (optional)</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>30.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Chip             index
to HERMES-SCEPTER pair for this pad</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>31.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Quad            index
to the quadrant for this pad</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>32.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Radial          index
to the radial group for this pad (see Layout tab panel)</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>33.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Col               index to the column for this pad</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>34.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Row             index
to the row for this pad</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Detector layout details come from the “Maia_384#.csv” file,
where “#” indicates the Maia generation (“A”, “B”, “C”, “D”, “G”).</p>

<h3><a name="_Toc208917348">Groups</a></h3>

<p class=MsoNormal>Assignment of detector channels to each “Group”, as well as
whether pileup is rejected for a Group of Throttling is applied, is set in the
Group tab panel. Groups are defined to select detectors for the following
accumulators:</p>

<p class=MsoNormal style='margin-left:72.0pt;text-indent:-18.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>0-11</b>       Up
to 12 spectra histogram accumulators (only 4 in current implementation ; 4K
each)</p>

<p class=MsoNormal style='margin-left:72.0pt;text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>12</b>           E-T
2D histogram accumulator (256 x 128)</p>

<p class=MsoNormal style='margin-left:72.0pt;text-indent:-18.0pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>13</b>           ET
event buffer (32K buffer)</p>

<p class=MsoNormal style='margin-left:72.0pt;text-indent:-18.0pt'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>14</b>           Dynamic
Analysis (DA) accumulator (also implements ROI as a special case)</p>

<p class=MsoNormal style='margin-left:72.0pt;text-indent:-18.0pt'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>15</b>           Dead-time
statistics accumulator</p>

<p class=MsoNormal style='margin-left:0cm'>&nbsp;</p>

<p class=MsoNormal><b><i>NOTE: Groups spectra have not been fully implemented
at this time. However, the settings for ET, DA are in use.</i></b></p>

<p class=MsoNormal style='margin-left:0cm'>&nbsp;</p>

<p class=MsoNormal>Each group has a 384 bit field to enable any combination of
detectors for the group. Groups can be defined arbitrarily. Use the Selection
Class droplist to group detectors and click on detector to toggle the selection
state of this detector as part of a Selection Class. Click on “Read” to read
back the current detector selection from Maia.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>To set-up a Spectrum accumulator, click on the row and
select detector channels on the mimic panel to the right. Then click on “SET”
in the row for this Spectrum. The Title can be edited in the “Edit Title” field
below the table – remember to hit &lt;return&gt; to make the change to the
current row. Pileup rejection can be enabled for this accumulator by toggling
the setting in the “PU Rej” column. Similarly, Throttling can be set in the
“Throt” column. </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Some rows are predefined for other accumulators (as listed
above). Row 12 can be set-up for the E-T 2D histogram accumulator, using a
similar approach to the Spectra Groups. There is only one E-T 2D histogram, so
you might vary this from time to time to monitor specific detectors, or a bank
of channels attached to one SCEPTER, for example.<i> (ET 2D is disabled at
present)</i></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Setting the detector channels for row 13 selects detector
channels for ET data records written to disk (and available to <i>Maia Control </i>as
a client for individual detector Spectra display and the ET2D plot). Normally,
this would select all detector channels (excluding those Disabled) and it may
have Throttling enabled to conserve disk space.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Row 14 is used to select detector channels for DA imaging.
This would normally use all detector channels and have Pileup rejection
enabled, but it would not need to use Throttling as HYMOD can easily process
all events in real-time.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><img width=604 height=434
src="Maia-384-user-help_files/image027.jpg"></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Set parameters and lookup tables for Groups in Maia by
clicking on “Apply to HYMOD”. Note that Group settings are not loaded and saved
using the buttons at the bottom of the window.</p>

<h3><a name="_Toc208917349">Imaging</a></h3>

<p class=MsoNormal>The Imaging tab panel is used to select a pre-calculated
Dynamic Analysis (DA) matrix file for real-time imaging, or a CUTs file to be
used for ROI definition. In the present version of Maia, only one of DA or ROI
can be in use at one time. ROI is implemented as a special case of DA, where
matrix rows are preset to achieve the same result as a ROI, optionally with
local background subtraction.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><i>NOTE: ROI are provided for completeness. However, using
DA is easier to set-up, unfolds element and peak overlaps and produces
quantitative maps that can be directly interrogated; hence it is preferred for
quantitative imaging.</i></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>A DA matrix is set-up using the normal GeoPIXE procedures.
See the GeoPIXE manual, or the GeoPIXE workshop examples (see “geopixe/Help”
dir), and the section on Data Analysis later in this manual. Select a DA matrix
by using the “Load” button and selecting the DA file. Click “enable” and “Apply
to Hymod” to transfer the matrix to Maia.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Before applying to Hymod, you will also need to select the
Epics/Tango PV used for flux measurement (if this is not set remotely via
metadata control from the Maia IOC) and a conversion factor from flux to
“charge” for quantification. These are set-up in a similar way to off-line
analysis in GeoPIXE, with one exception. The “Scan data for PVs” button will
prompt for some existing Maia raw ‘blog’ data files (although this is seldom
needed if rich metadata is supplied to <i>blogd</i> from the beamline
Epics/Tango environment). These will be scanned for Epics/Tango PVs to populate
the “IC Scaler channel” droplist. Choose recent files that contain all
necessary PVs. Metadata control from the beamline system to the Maia Epics/Tango
IOC obviates the need for much of this set-up and the correct values are
usually set already.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='layout-grid-mode:both'><img width=604
height=441 src="Maia-384-user-help_files/image028.jpg"></span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>A CUTs file, used for ROI, is set-up using the <i>Cut Setup</i>
Window (opened from the <i>Spectra Display</i> window in <i>GeoPIXE</i> or the <i>Group
Spectra</i> or<i> ET Spectra</i> windows in <i>Maia Control</i>). It enables
the definition of simple ROI as CUTs defined using the two View markers, or
ones that enable local background subtraction using the X0-X5 markers to define
a left background (X0-X1) the peak of interest (X2-X3) and a right background
(X4-X5) region of the spectrum. Click on “<span style='font-family:Symbol'>S</span>”
in the <i>Spectrum Display</i> window to use the current position of the View or
X markers, and then edit the title field for this CUT in the <i>Cut Setup</i>
window.</p>

<h3><a name="_Toc208917350">Controls</a></h3>

<p class=MsoNormal>The Controls tab panel displays the current state of
detector operation parameters (bias read-back, leakage and temperature),
various temperatures in the DDM and DAM modules, the DDM supply voltage Vcc and
allows the control of detector Bias, Peltier cooling current and Guard ring
voltage (in a later version). </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The detector Temperature and Leakage read-back fields are on
the left under “Monitor”, and Peltier and Bias controls under “Controls” on the
right. Increment the control sliders by clicking to the right of the ‘handles’
to increase by 10 or use the arrows at the ends of the slider to change by 5.
Never increase the bias or Peltier in increments larger than 10, and preferably
by 5 as you approach the final settings (see the Safe Operation section under <b><i>cool
down</i></b>). Avoid holding and dragging the controls to avoid wild swings. Alternatively,
just type in the new value in the box.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='layout-grid-mode:both'><img width=605
height=440 src="Maia-384-user-help_files/image029.jpg"></span></p>

<h3><a name="_Toc208917351">Layout</a></h3>

<p class=MsoNormal>The Layout tab panel allows the definition, or correction,
of pad number assignments across the array (see notes at top of window), and
also the assignment of pads to various groupings based on:</p>

<p class=MsoNormal style='margin-left:72.0pt;text-indent:-18.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Chip             connection
to a specified HERMES-SCEPTER pair</p>

<p class=MsoNormal style='margin-left:72.0pt;text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Quadrant    member
of a quadrant of the array</p>

<p class=MsoNormal style='margin-left:72.0pt;text-indent:-18.0pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Radial          member
of a radial group, number out from the centre (see below)</p>

<p class=MsoNormal style='margin-left:72.0pt;text-indent:-18.0pt'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Column       member
of a column, numbered from left</p>

<p class=MsoNormal style='margin-left:72.0pt;text-indent:-18.0pt'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Row             member
of a row, numbered from the top</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The values for these classes are updated when a pad is
clicked on the mimic display on the right.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>It is unlikely that users or beamline scientists will need
to change any of these assignments.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>End users, however, may wish to change the Radial classes.
These can be set automatically, based on a pitch value (mm). The “Set Radial
Classes” button will use detector pad XY position and bin these into bins of
width “pitch” based on radial distance from the centre of the array. Remember
to save the layout after doing this.</p>

<h3><a name="_Toc208917352">Pulser / Tests</a></h3>

<p class=MsoNormal><i>Note that the built-in pulser is only available on the
full Maia 384 detector system with the new back-end DDM. In the case of Maia 96,
the only pulser that is available is the simple “synth” simulator.</i></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The Pulser tab panel provides a number of real and
synthesized pulser functions selected using the top droplist:</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Pulse
selected channels</b>, which will generate a single pulser peak in selected
channels. Take care not to select more that 7 detector pads on each chip, as
this will overload SCEPTER (typically, select only one per chip). Select the
pulser amplitude and count rate and click on “Enable pulser” to start the
pulser.</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Run
“step-cal” procedure,</b> which will generate a series of evenly spaced pulser
peaks across the E spectra of selected detector channels to be used to test and
correct for non-linearity (also used to define the pileup field). Set-up the
“Low” and “High” pulser amplitude and “Count”, which is the number of peaks to
generate between Low and High, and “Time”, which is the counting time on each
peak, and a count “Rate” of about 1000. Run it by clicking on “Execute
step-cal”, which will generate a script of commands that are listed below and
tracked during execution.</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Run
“gain-trim” procedure</b>, which will generate two pulser peaks in the E and T
spectra of selected detector channels. This is used to build gain-trimming
calibration lookup tables. Set-up the “Low” and “High” pulser amplitude for the
two peaks and “Time”, which is the counting time on each peak, and a count
“Rate” of about 1000. Run it by clicking on “Execute gain-trim”, which will
generate a script of commands that are listed below and tracked during
execution. Also used for the FWHM test procedure (using Low=High).</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Synth
pulser</b>, which simply injects the desired E and T values into the front-end
of HYMOD for the selected channels, bypassing the analogue electronics.</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Leakage
mapping,</b> which uses the HERMES ELK mechanism to probe leakage current in
each channel in turn and produce a map of leakage across the detector. The map
is displayed on the “Detector Leakage Map” panel of the <i>Maia Rates</i>
window and as a parameter map for ELK on the <i>Maia Setup</i> window. </p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>6.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Baseling 
mapping,</b> which uses a Maia ADC to probe the average DC level on each HERMES
output as a probe of baseline using the EAN selection mechanism and the OAN
output. </p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>7.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Run
“step-cal ALL” procedure,</b> which will perform the “step-cal” procedure, but
now sequentially for all channels. This can be used to investigate linearity
across the array.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>If any pulser/test function is left active, a Red “STOP
Pulser” button will appear on the <i>Maia Setup</i> window to indicate the
fact, and to provide a simple way to switch it off prior to normal data
collection.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><img width=604 height=434
src="Maia-384-user-help_files/image030.jpg"></p>

<h3><a name="_Toc208917353">Debug</a></h3>

<p class=MsoNormal>The Debug tab panel is used to select a single channel of
HERMES or SCEPTER output and route it to the Lemo connector on the detector
housing. </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The top panel can select a single detector channel HERMES
pulse output to route to the OAN Lemo output connector (Lemo #2 on the detector
body).</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The next panel can select a single detector channel SCEPTER
output to route to the AUX Lemo output connector (Lemo #1 on the detector
body). If this is enabled, SCEPTER multi-channel arbitration is disabled and
only a single channel is routed to this output.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>If any debug functions are left active, a Red “STOP Debug”
button will appear on the <i>Maia Setup</i> window to indicate the fact, and to
provide a simple way to switch it off prior to normal data collection.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><img width=604 height=434
src="Maia-384-user-help_files/image031.jpg"></p>

<b><span style='font-size:16.0pt;font-family:"Arial",sans-serif;layout-grid-mode:
line'><br clear=all style='page-break-before:always'>
</span></b>

<h1><a name="_Ref259026030"></a><a name="_Ref259026047"></a><a
name="_Ref259026099"></a><a name="_Toc208917354">Maia Pipeline Set-up</a></h1>

<p class=MsoNormal>Set-up of the Maia processing pipeline can be divided into 3
groups: (i) fundamental detector response characterization and set-up that is
done only occasionally and should cater for a wide range of experiments and
data (Linearization, Gain trimming, Energy Calibration, Dead-time calibration
and Pile-up Rejection), (ii) set-up for diagnostic monitoring of a measurement
(e.g. Groups, Spectra and ET 2D histograms), and (iii) set-up that is more
specific to a particular experiment, beam energy and sample suite (Throttling,
DA or ROI imaging) and will need to be reconsidered for each experiment or
sample.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Preliminary analysis and pipeline set-up are carried out
using the<i> Maia Control</i> windows, using on-line data directly, or the
equivalent windows in <i>GeoPIXE</i>, using off-line analysis of data saved as
spectra files or logged to <i>blogd</i>.</p>

<h2><a name="_Toc208917355">Setting Thresholds</a></h2>

<p class=MsoNormal><b><i>Note: Initial values for Thresh (and Trim) may have
been provided with your Maia detector.</i></b></p>

<h3><a name="_Toc208917356">Thresh</a></h3>

<p class=MsoNormal>Initially Maia may show various patters of noise rates
across the array. We can use this noise to adjust all threshold parameters (THRESH
and TRIM) to even out differences between channels. These parameters have
probably been setup before you received your Maia detector. To view them, use
the “Show Parameters” mode and click on the selector check-box to the right of
“Trim”, “Thresh-Trim” or “Thresh” on the SCEPTER tab.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>To start again and set these from scratch, first, select the
main parameter group on SCEPTER tab and start by setting all THRESH high (e.g.
0.7 V) and reduce them all down in 0.03 V steps until you see noise rates on several
chips. You could set class to “All” and click on one channel to toggle it and
all channels ON (displayed green).</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Select just these noisy chips and use the up arrow next to THRESH
to increase the THRESH for these chips by 1-2 clicks (hit “Apply to SCEPTER”).
This will raise the THRESH for these chips and reduce their noise. Repeat this
for other noisy chips. Now lower the THRESH for all chips again by 1-2 clicks
(using arrow button with all channels selected) to increase noise rates on all.
Repeat this procedure until all chips have a similar general noise rate. Lower
all THRESH so that the colours generally span blue through to orange.</p>

<h3><a name="_Toc208917357">Trim</a></h3>

<p class=MsoNormal>Now select the TRIM group of parameters on the SCEPTER tab.
Focus attention on one chip or quadrant, and select all pads that show higher
rates (yellow, orange, red, violet) and use the up arrow button next to TRIM to
increase the overall thresholds for these (THRESH combined with TRIM). Do this
until all become blue or green. Repeat for all chips.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Now return to the first chips again and select all pads that
show black or occasional dark-blue rates and adjust down arrow to lower their
combined thresholds. Many of these will start to show rates. A few may not
respond – they could be dead or with very low noise. In this way you start to
even out the noise in all channels.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Finally, increase the THRESH on all channels by about 4
clicks, which should silence all channels and provide some latitude above noise.
Save all parameters using the “Save Maia Parameters” button to a directory used
for Maia config (e.g. “config/&lt;detector&gt;/setup”, where &lt;detector&gt;
is the Maia name code, such as “384D21”).</p>

<h2><a name="_Toc208917358">Detector Linearization</a></h2>

<p class=MsoNormal>Non-linearity of the detector response with energy is probed
and characterized using the built-in test pulser and the “step-cal” procedure,
which produces a series of pulser peaks in a selected spectrum at equally
spaces intervals across the full energy range. The linearization analysis and
correction is aimed at refining a correction function that removes errors in
centroid position so that these peaks have the same separation across the
spectrum. </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The main aim of linearization correction is to build a
correction for a module in the FPGA pipeline, so that linearity is removed in E
data produced by Maia. Once linear, we do not need any further corrections.
However, it can also be used to build a correction as a fine adjustment to
linearity, to handle any residual non-linearity that remains, and used in
GeoPIXE processing. The example below “Linearization using X-ray standard
spectra” is such a second order further refinement to linearity that gets used
in GeoPIXE.</p>

<h3><a name="_Toc208917359">Running “step-cal”</a></h3>

<p class=MsoNormal>Open the <i>Maia Setup</i> window and go to the “Pulser” tab
page. Select the “Step-cal” pulser mode. “Step-cal” will generate a series of
evenly spaced pulser peaks across the E spectra of selected detector channels
to be used to test and correct for non-linearity.  Set-up the full E range
using the “Low” and “High” pulser amplitudes and set “Count”, which is the
number of peaks to generate between Low and High; a value of ~20-50 or more works
well if you choose detector channels with good resolution (make sure the peaks
are clearly separated). Set “Time”, which is the counting time on each peak. See
the example window view above under “Pulser”.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Typically, settings for this step-cal procedure will be
stored in file “<b>maia/</b><b>Maia-384-linearity.pulser.csv</b>” in the
geopixe directory, or your <b>local laboratory Config directory (“config/&lt;detector&gt;/setup/”)</b>.
Use the “Load Pulser Parameters” button to load these settings. The script uses
some arbitrary channel selections on each HERMES chip. If necessary, if for
example one of these is a disabled channel, you can change these by toggling
the channel selection on the detector mimic display.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Now disable both “linearization” and “Gain trimming” on the
“Enable” tab page of <i>Maia Setup</i>. Run the step-cal procedure by clicking
on “Execute step-cal”, which will generate a script of commands and step
through them. The commands are listed in the list-view on the Pulser tab page
and tracked through during execution. A new blog run will be started (<b>note
this blog #</b>) and data will be logged there. See the current run number in
the Control display frame.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='page-break-after:avoid'><img width=605 height=413
src="Maia-384-user-help_files/image032.jpg"></p>

<p class=MsoNormal><i>A “step-cal’” spectrum (count=24) generated for detector
#80 (actually one detector on each SCEPTER was enabled). Make sure the “Low”
value starts near or below the lower threshold and the “High” value starts near
or extends off the top of the spectrum range. A larger value of “Count” would
have been better in this case.</i></p>

<h3><a name="_Toc208917360">Executing Linearization plug-in</a></h3>

<p class=MsoNormal>There are two approaches to analyze the linearization data
in <i>GeoPIXE</i>, either using saved spectra or extracting spectra from blog
event data. </p>

<h4>GeoPIXE – blog data</h4>

<p class=MsoNormal>Import spectra from the blog run file using the “file<span
style='font-family:Wingdings'>à</span>Import Spectra” menu in the <i>Spectrum
Display</i> window by selecting a few blog data files. Select <b>just one</b>
of the E spectra for just one of the channels (use the <i>Spectrum Select </i>window,
“Select” button, click on a row in the table of spectra, and click “One”).</p>

<h4>GeoPIXE – saved spectra</h4>

<p class=MsoNormal>Save the spectra from <i>Maia Control</i> (“Maia E Spectra Display”
window) into a local SPEC file. Load these into GeoPIXE’s Spectrum Display
window. Select <b>just one</b> of the E spectra for just one of the channels
(use the <i>Spectrum Select </i>window, “Select” button, click on a row in the
table of spectra, and click “One”).</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>In <i>Spectrum Display</i>, set the View markers to bracket
all WHOLE peaks (see figure above – click to set Right View marker first, then
click to set Left one). Do not include a partial peak at the ends (as in the
spectrum above at both ends). Now run the linearity plug-in (“<b><i>Build
Linearize2 by Chip</i></b>”) in the <i>Spectrum Display</i> “Process<span
style='font-family:Wingdings'>à</span>User Plugins” menu. A pop-up enables the
selection of either (i) a single polynomial function fit to linearity, or (ii)
a two component fit, and the path to the output file (put this in your config
area used for Maia calibration files).</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>For the two component model, the plug-in analyses just one
spectrum, and determines the centroids of all peaks and fits two functions in
two passes: (i) an exponential function that targets any small non-linearity at
low energies, and (ii) an polynomial function to pick up any residual. The one
component model just uses the polynomial model. The one component model works
well for all new Maia C, D units. </p>

<p class=MsoNormal style='margin-left:0cm'>&nbsp;</p>

<p class=MsoNormal style='margin-left:65.45pt'><img width=553 height=371
src="Maia-384-user-help_files/image033.jpg"></p>

<p class=MsoNormal style='margin-left:65.45pt'><i>Detector #14 after one pass
(violet) and 2 passes (red), an example from the Maia 96 prototype.</i></p>

<p class=MsoNormal style='margin-left:65.45pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:65.45pt'><img width=553 height=371
src="Maia-384-user-help_files/image034.jpg"></p>

<p class=MsoNormal style='margin-left:65.45pt'><i>Detector #14 showing fit to
residual in 2<sup>nd</sup> pass.</i></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:65.45pt'><span style='layout-grid-mode:
both'><img width=553 height=322 src="Maia-384-user-help_files/image035.jpg"></span></p>

<p class=MsoNormal style='margin-left:65.45pt'><i><span style='layout-grid-mode:
both'>Single component fit to a channel from a Maia 384B detector array</span></i></p>

<p class=MsoNormal style='margin-left:0cm'>&nbsp;</p>

<p class=MsoNormal>The Linearization plug-in writes a file with the same name
as the spectrum file, but with the extension “.linear.var”. Save this file in a
central <b><i>Config</i></b> location agreed for your laboratory for Maia
detector parameters and calibrations (e.g. “config/&lt;detector&gt;/linear/”). </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The new Linearize2 plugin performs the fitting to data from
each chip, so you end up with 12 plots showing the residual non-linearity and
the fit to it. The new output file (extension “.linear.var” in varsh format)
contains parameters for a linearization correction for each chip. This requires
<b><i>Kandinski version 9542</i></b>, or later. Typically, save the Linearity
correction to a file in your <b>local laboratory Config directory (“config/&lt;detector&gt;/linear/”)</b>.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>This linearization file can be selected using the
Linearization “load” button on the HYMOD tab page of <i>Maia Control</i>. Make
sure the “Send” checkbox is set. On “Apply to HYMOD” a lookup table will be
loaded into HYMOD to perform real-time linearization. This will enable
“Linearization” in the FPGA as well.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Now on the “Enable” tab page, check that “Linearization” is
enabled. If you like, you can repeat the linearization script to collect a new
run and then the analysis using the plugin. The result should now show a flat
curve indicating little residual non-linearity.</p>

<h3><a name="_Hlk169097709"></a><a name="_Toc208917361">Linearization using
X-ray standard spectra</a></h3>

<p class=MsoNormal>A new plugin (“Build Linearize using Cut named Energies”)
can be used to fit a linearity correction based on clearly resolved X-ray peaks
and their centroids calculated using CUTs. </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><i>It is typically used to construct a second iteration
linearization correction in post processing to correct for residual non-linear
behaviour. This can be used in post-processing in GeoPIXE and selected in the
“Linearize” file fields for importing spectra or sorting images in Sort EVT to
provide a second order correction to linearization.</i></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Peaks are selected by creating a CUTs file (see below) with
each named to indicate the element label and the centroid energy for the line
(group), separated by a space. In the example “S 2.31” is used to label the cut
and set its energy to 2.31 keV for the linearization. Labels can also simply
use the energy alone (e.g. “2.31”).</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='layout-grid-mode:both'><img width=600
height=313 src="Maia-384-user-help_files/image036.png"></span></p>

<p class=MsoNormal style='margin-left:0cm'>&nbsp;</p>

<p class=MsoNormal><span style='layout-grid-mode:both'><img width=602
height=472 id="Picture 4" src="Maia-384-user-help_files/image037.jpg"></span></p>

<p class=MsoNormal><i>Executing the plugin we get this correction to
linearization.</i></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='layout-grid-mode:both'><img width=602
height=389 id="Picture 7" src="Maia-384-user-help_files/image038.jpg"></span></p>

<p class=MsoNormal><i>Initial spectrum and fit, showing some residual
non-linearity</i></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='layout-grid-mode:both'><img width=602
height=389 id="Picture 10" src="Maia-384-user-help_files/image039.jpg"></span></p>

<p class=MsoNormal><i>Re-fitted after application of the Linearization above
(use “Apply linearization” spectrum plugin)</i></p>

<h4><a name="_Toc390920565">To use this Linearization adjustment</a></h4>

<p class=MsoNormal>This linearization assumes that the data has been linearized
originally (in Maia), and then this linearization is applied as a second order
correction during off-line processing, for both Import of spectra and Sorting
of Images, as a fine adjustment. For import, select the option “with
linearization”. For Image sorting, fill in the “Linearize” field on the Files
tab.</p>

<h3><a name="_Toc208917362">Linearization using Peak Offsets in Fit</a></h3>

<p class=MsoNormal>A new plugin (“Build Linearize using peak offsets in fit”)
can be used to fit a linearity correction based on the differences between
peaks in a spectrum and the same peaks in the fit to the spectrum. </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><i>It is normally used to construct a second iteration
linearization correction in post processing to correct for residual non-linear
behaviour. This can be used in post-processing in GeoPIXE and selected in the
“Linearize” file fields for importing spectra or sorting images in Sort EVT to
provide a second order correction to linearization.</i></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Firstly, fit a spectrum with nicely spaced peaks that cover
as much of the useful energy range as possible. This is important, as the
linearity correction polynomial will probably diverge outside this energy range
and quickly become meaningless. Fit the spectrum in GeoPIXE <i>Xray Spectrum
Fit </i>and set CUTs on all clear peaks to use in the analysis. Unlike the
method above, this does not need special rules for naming each CUT. Save the
CUTs to a file, then call the spectrum plugin “<b>Build Linearize using peak offsets
in Fit</b>”, which will prompt for the CUTs file and then plot the correction
(just a single correction for all chips).</p>

<h4>To use this Linearization adjustment</h4>

<p class=MsoNormal>This linearization assumes that the data has been linearized
originally (in Maia), and then this linearization is applied as a second order
correction during off-line processing, for both Import of spectra and Sorting
of Images, as a fine adjustment. For import, select the option “with
linearization”. For Image sorting, fill in the “Linearize” field on the Files
tab.</p>

<h2><a name="_Toc208917363">Gain Trimming</a></h2>

<p class=MsoNormal>Gain trimming is designed to correct for the small gain and
offset differences between detector channels. <b>NOTE: This will be needed
after any changes of SCEPTER</b> <b>Threshold, Trim or HERMES Gain, Time</b>, or
to Linearity, which all effect peak positions. Once corrected, both E and T
spectra from all detectors should have similar gain and offset and can be
overlaid and added together. The latter is essential for the Pileup correction
approach, the ET2D display and the Groups Spectra to provide a useful sum of
selected detector spectra. </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Differences in gain and offset are characterized using the
built-in test pulser and the “gain-trim” procedure, which produces a pair of
pulser peaks (a “low” and “High” peak) in both E and T in all detector channels
in turn. The method uses a pair of peaks, at both ends of the E and T range,
and the algorithm determines a linear mapping for all channels to match these
peaks to those in the average detector channel.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><b><i>NOTE: Gain-trimming should be done AFTER Linearization
has been completed and the Linearization module is set-up and enabled in the
FPGA (after “Apply to HYMOD” on the HYMOD tab and enabled on “Enable” tab).
THEN collect data to be used to define gain trimming.</i></b></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>To accommodate drift, adjustment to gain-trimming can be performed
from time to time. This can be done using the “Gain trim Adjustment” procedure
described below.</p>

<h3><a name="_Toc208917364">Running the “gain-trim” pulser</a></h3>

<p class=MsoNormal>Open the <i>Maia Setup</i> window and go to the “Pulser” tab
page. Select the “gain-trim” pulser mode. “Gain-trim” will generate a pair of
pulser peaks in the E and T spectra of selected detector channels.  Set-up the
pair of peaks to span the full E range using the “Low” and “High” pulser
amplitudes. Set “Time”, which is the counting time on each peak. It’s a good
idea to save the pulser set-up in a file for next time. </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Typically, settings for this gain-trim procedure will be
stored in file “<b>Maia-384-gaintrim2.pulser.csv</b>” in the “local laboratory <b><i>Config</i></b>
directory (an initial one can be found in “geopixe/maia”). Use the “Load Pulser
Parameters” button to load these settings. The script will step through all
channels, so there is no need to play with channel selection on the detector
mimic display.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Now disable “Gain trimming” on the “Enable tab page of <i>Maia
Setup</i> (make sure that “Linearization” remains enabled, and that a valid
linearization file has been loaded, as described earlier). Run the procedure by
clicking on “Execute gain-trim”, which will generate a script of commands and
step through them. The commands are listed in the list-view on the Pulser tab
page and tracked through during execution. A new blog run will be started, and
data will be logged there. See the current run number in the Control display
frame.</p>

<p class=MsoNormal style='margin-left:0cm'>&nbsp;</p>

<p class=MsoNormal><img width=605 height=413
src="Maia-384-user-help_files/image040.jpg"></p>

<p class=MsoNormal><i>Overlay of 96 E spectra from the Maia prototype showing
pairs of pulser peaks from the “gain-trim” procedure, displayed in “Highlight”
mode with detector #14 selected (in green).</i></p>

<h3><a name="_Toc208917365">Executing the Gain Trimming Plug-in</a></h3>

<p class=MsoNormal>There are two approaches to analyze the gain-trim data.
Either use, either using saved spectra or extracting spectra from blog event
data. </p>

<h4>GeoPIXE – blog data</h4>

<p class=MsoNormal>Import spectra from the blog run file using the “file<span
style='font-family:Wingdings'>à</span>Import Spectra” menu in the <i>Spectrum
Display</i> window by selecting a few blog data files. Select <b>just one</b>
of the E spectra for just one of the channels (use the <i>Spectrum Select </i>window,
“Select” button, and click “All”).</p>

<h4>GeoPIXE – saved spectra</h4>

<p class=MsoNormal>Save the spectra from <i>Maia Control</i> (“Maia E Spectra
Display” window) into a local SPEC file. Load these into GeoPIXE’s Spectrum
Display window. Select <b>just one</b> of the E spectra for just one of the
channels (use the <i>Spectrum Select </i>window, “Select” button, and click
“All”).</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><i>This will display all E spectra for determining the E
gain-trims. You will also need to repeat the steps below for all T spectra (by
deleting all XYE spectra) to determine T gain-trims.</i></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Now in <i>GeoPIXE</i>, select all E spectra and place View
markers around both peaks in all detector channels (see spectra above). Make
sure there is no existing energy calibration set (use the “Display<span
style='font-family:Wingdings'>à</span>Clear ALL Energy Cals” menu). </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Now run the gain-trim plug-in (“* Build Gain Trim Plug-in”;
the “*” indicates that this plug-in processes all selected spectra) under the
“Process<span style='font-family:Wingdings'>à</span>User Plugins” menu in the<i>
Maia E Spectra Display</i> (online in <i>Maia Control</i>) or <i>Spectrum
Display</i> (off line in GeoPIXE) window. A pop-up window allows setting some
parameters for the Gain-trim plugin. These set (i) the output file name and
path, (ii) the maximum ratio of peak intensity relative to the largest peak (a
value of 0.3 is adequate here), (iii) the level below the maximum to use in
each peak to determine centroid (use values like 0.3-0.6), and (iv) the
pre-smoothing to apply to each spectrum first to smooth out local minima due to
noise (values of 10 for E and 2-3 for T spectra work well). The default
settings generally work well.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Gain-trim will adjust the energy calibration of all E spectra
to match the peaks to the average. The Gain-trim plug-in writes a file with the
same name as the spectrum file, but with the extension “.energy.gaintrim.var”. </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><b>Save this file in a central <i>Config</i> location agreed
for your laboratory for Maia detector parameters and calibrations. </b>Typically,
save the gain-trim correction coefficients to a file in your <b>local
laboratory Config directory (“config/&lt;detector&gt;/setup/”)</b>.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Repeat the above procedure (select all T spectra, the run
gain-trim plugin) for all T spectra. Gain-trim will adjust the energy
calibration of all T spectra to match the peaks to the average. The Gain-trim
plug-in writes a file with the same name as the spectrum file, but with the
extension “.time.gaintrim.var”. Save this file in a central <b><i>Config</i></b>
location agreed for your laboratory for Maia detector parameters and
calibrations.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><i>If some channels of the T spectra fail to fit correctly,
you can use the Cal window to manually calibrate those channels to match all
other channels. In this case, then save the spectra from the Spectrum Window to
a SPEC file and use that file for T gain-trimming.</i></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The E gain-trim file can be selected using the “Gain Trim E
File” “load” button on the HYMOD tab page of <i>Maia Control</i>. The T E
gain-trim file can be selected using the “Gain Trim T File” “load” button
(either the .gaintrim..time.var or .spec file). Make sure the “Send” checkbox
is set. On “Apply to HYMOD” the gain-trim tables will be loaded into HYMOD to
perform real-time gain-trimming. This should also enable “Gain trimming” on the
Enable” tab.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Now on the “Enable” tab page, check that “Gain trimming” is
enabled. If you like, you can repeat the gain-trim script and plugin (but do
not disable the gain-trim module). The result should now show spectra peaks for
all E spectra overlapping indicating good trimming, and similarly for all T
spectra.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><img width=605 height=413
src="Maia-384-user-help_files/image041.jpg"></p>

<p class=MsoNormal><i>Overlay of 96 E spectra from the Maia prototype showing
pairs of pulser peaks after application of  the “gain-trim” procedure off-line
in GeoPIXE.</i></p>

<p class=MsoNormal style='margin-left:0cm'>&nbsp;</p>

<p class=MsoNormal><img width=605 height=413
src="Maia-384-user-help_files/image042.jpg"></p>

<p class=MsoNormal><i>Overlay of 96 T spectra from the Maia prototype showing
pairs of pulser peaks after application of  the “gain-trim” procedure off-line
in GeoPIXE. This was done simultaneously with the E spectra shown above in a
single pass.</i></p>

<h3><a name="_Toc208917366">Gain-trim adjustment after minor TRIM or THRESH
changes</a></h3>

<p class=MsoNormal>Changes to SCEPTER values for individual (TRIM) or per chip
thresholds (THRESH) will move peaks in T spectra. The solution is to either
repeat the full Gain-trim procedure using the pulser, or for small changes (few
channels corrected), the following method can be used.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>After making changes to TRIM for a few channels, run the
pulser for a fixed amplitude and display T spectra showing all changed
channels, plus a reference good channel that was not changed. Use the <i>Spectrum
Select</i> window to select channels (e.g. using the “Array …” pop-up window). For
each adjusted channel, select it in the T spectrum (e.g. use “Highlight” mode
and click on this detector in the <i>Spectrum Select</i> table) and then use
the Arrow buttons on the HYMOD tab of the <i>Maia Setup</i>” window to adjust
the T gain trim offset. The arrows are labelled “Adjust T Offsets” and are
located below “Gain Trim T File” field under “Gain Trimming”. Select the
desired channel on the detector mimic panel on the right (use “Individual”
selection mode). Then, while the pulser is still running, click on the Up arrow
once and hit “Apply”. Observe which way the peak moves in the T spectrum and
use more “Up” clicks or go for “Down” instead. Repeat adjustments (click
“Clear” in between) until the adjusted channel T peak matches the reference
channel and repeat for other channels.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Once changes have been made, click on “Save”, which will
prompt for a file-name ( .gaintrim.time.var) for the new T gain-trim
parameters. This name will also be set in the “Gain Trim T File” field.
Remember to “Save Maia Parameters” to capture these new SCEPTER and gain-trim
parameters to file.</p>

<h3><a name="_Toc208917367">Gain-trim using a dual X-ray source</a></h3>

<p class=MsoNormal>An X-ray source that produces at least 2 well separated
X-rays lines can also be used to define the gain-trim linear mapping. This can
be a little tricky as the source lines may have very different intensity and
may require attention to detail. The following is an example of using combined <sup>55</sup>Fe
(Mn K X-rays) and <sup>109</sup>Cd (Ag K X-rays) sources.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><b><i>NOTE: This is not the usual approach to gain trimming.
To avoid some of the complications mentioned here, use the pulser gain-trim
method followed by the method described below for individual channel energy
calibration.</i></b></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><img width=604 height=417
src="Maia-384-user-help_files/image043.jpg"></p>

<p class=MsoNormal><i>Uncalibrated, un-gain trimmed E spectra using combined <sup>55</sup>Fe
(Mn K X-rays) and <sup>109</sup>Cd (Ag K X-rays) sources. Linearization was
applied during extraction in GeoPIXE using file “306-det-14-36-80.linear”.</i></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><img width=604 height=417
src="Maia-384-user-help_files/image044.jpg"></p>

<p class=MsoNormal>T<i>he same spectra after successfully applying the “* Build
gain trim” plugin. Note the placement of the View markers to exclude the odd
channel artefacts.</i></p>

<p class=MsoNormal style='margin-left:0cm'><i>&nbsp;</i></p>

<p class=MsoNormal><i><img width=604 height=417
src="Maia-384-user-help_files/image045.jpg"></i></p>

<p class=MsoNormal><i>Un-gain trimmed T spectra using combined <sup>55</sup>Fe
(Mn K X-rays) and <sup>109</sup>Cd (Ag K X-rays) sources. </i></p>

<p class=MsoNormal><i>&nbsp;</i></p>

<p class=MsoNormal><i><img width=604 height=417
src="Maia-384-user-help_files/image046.jpg"></i></p>

<p class=MsoNormal>T<i>he same T spectra after successfully applying the “*
Build gain trim” plugin.</i></p>

<h3><a name="_Toc208917368">Gain Trim Adjustment using a source</a></h3>

<p class=MsoNormal>Once gain-trimming for E and T has been established using
the pulser, and uploaded and enabled in Maia, it can be adjusted using the
following procedure. Small differences between pulser input to each detector
channel produce some variance in peak position, which means that adjustment is
a good idea to remove the effect of these differences on gain-trimming. This is
best done using dual element fluorescence lines (not scatter peaks) or multiple
peaks from a source (<sup>55</sup>Fe [Mn K lines] alone is not adequate; use <sup>55</sup>Fe
together with <sup>109</sup>Cd [Ag K lines], for example). For this adjustment,
leave Gain-Trimming <u>enabled</u> in Maia and collect data from this source,
or dual element fluorescence lines.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><b><i>NOTE: This is not the usual approach to gain trimming.
To avoid some of the complications mentioned here, use the pulser gain-trim
method followed by the method described below for individual channel energy
calibration.</i></b></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>This approach uses the “Gain Trim Xcuts” spectrum plugin, on
the <i>Spectrum Display </i>“Process<span style='font-family:Wingdings'>à</span>Plugin”
menu. First, clear all energy calibration using the Display menu. Position X
markers around the two dominant peaks you intent to use, starting from the
right with X5. Click and position the marker, then proceed to position the next
marker (lower number) by clicking to the left (well away from the first) and
dragging the marker into position. This procedure works for both T and E
spectra. For T, make sure the peaks are well separated. </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Then apply the “Gain Trim Xcuts” spectrum plugin. This
should change energy calibration to make the peaks for all detectors fall at
the same position on the spectrum display. If not, you may need to manually
correct channels in error. This can be tricky to get right.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><img width=601 height=362
src="Maia-384-user-help_files/image047.jpg"></p>

<p class=MsoNormal><i>T spectrum after T gain-trimming adjustment. X markers for
the Gain_trim_Xcuts spectrum plugin are shown. Unity energy cal for T needs to
be set back manually after gain-trim plugin is used.</i></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Now we need to apply this new calibration to correct the
original gain-trimming calibration that you have loaded in Maia. To do this,
use the “<b>Gain Trim Adjust</b>” spectrum plugin, on the <i>Spectrum Display </i>“Process<span
style='font-family:Wingdings'>à</span>Plugin” menu. It will prompt for the
file-names for the original Gain-trimming calibration spec file and the new
adjustment spec file, and then for an output file-name for a new corrected
gain-trimming spec file. This becomes the new file to upload into Maia (Hymod
panel on <i>Maia Setup</i>). Repeat this for both E and T spectra cases. To
test that this new gain-trimming works, <b>clear all energy cals </b>again and
collect more data from the source. The peaks from all detectors should now line
up.</p>

<h2><a name="_Toc208917369">Pile-up Rejection</a></h2>

<p class=MsoNormal>Without pile-up, time-over-threshold T follows a curve as a
function of E, which reflects the width of each pulse at a fixed threshold.
Pile-up causes the T value to exceed this curve. Pile-up rejection relies on
selecting a field that encloses all good events and rejects all the longer T
pile-up events. At present, this is done using the<i> Time Amplitude</i> window
in GeoPIXE (see the Windows menu in the<i> Spectrum Display </i>window). Use
the File menu to drag-select a range of recent raw blog files to scan for E and
T. By default, the first 100k events are plotted on an E-T scatter plot for all
detectors. Selected detectors can also be displayed, and more events can be
scanned by entering the number of events in the <b>Events</b> field. Reload the
blog data if this is changed.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><b><i>The Time Amplitude window can also be used to overlay
the pile-up limits defined in a pile-up file (see “Display” menu). This is a
useful check to perform regularly to make sure that the current pileup limits
are still correct for new data.</i></b></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>To define the pile-up acceptance field, position the mouse
cursor on the start of the curve at low E-T (e.g. at about [400,200] in the
example below) and then click and drag out a straight line up to the top of the
curve (e.g. [3500,368]). Try to extend your field to the top of the spectrum
(works best using a higher energy beam to provide events and pileup right up the
spectral range).This line has control points along the centre-line that can be
used to drag it into a spline curve shape to follow the curve. This takes some
care, and usually benefits from a closer spacing of control points at lower E end
in order to follow the sharper curvature at lower E, as shown below. Once the
shape is defined, the width can be adjusted using the two handles on the sides
(top and bottom adjacent to the middle control points) of the red box. The
final field can be saved using the File menu for use in <i>Maia Setup</i> to
define pile-up rejection. Typically, save the pileup definition to a file in
your <b>local laboratory Config directory (“config/&lt;detector&gt;/pileup/”)</b>.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><b><i>NOTE: Pile-up rejection set-up should follow AFTER both
linearization and Gain-Trimming have been completed and the Linearization and
Gain-trimming modules are set-up and active (enabled) in Maia. THEN collect
data to be used to define the pile-up acceptance field.</i></b></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><img width=464 height=535
src="Maia-384-user-help_files/image048.jpg"></p>

<p class=MsoNormal><i>Time Amplitude display (GeoPIXE Spectrum Display Windows
menu) for all detector channels extracted from raw Maia blog data files for
100k events. The red spline field selects the range of T as a function of E
that will be accepted; all other events will be rejected as pile-up events.</i></p>

<p class=MsoNormal style='margin-left:0cm'>&nbsp;</p>

<h2><a name="_Toc208917370">Energy Calibration</a></h2>

<h3><a name="_Toc208917371">A single energy cal for all</a></h3>

<p class=MsoNormal>Ideally, after linearization and gain-trimming you only
really need a single energy calibration for all detector channel E spectra. A
single representative spectrum can now be calibrated for energy. There are two
approaches:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Fit
the spectra recorded for this detector (with the Linearization and Gain
trimming modules set-up and enabled) using <i>X-ray Spectrum Fit</i>.</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Mark
peaks manually and use the “Display-&gt;Calibrate Energy” menu function.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The fitting method produces the most accurate calibration
and is well worth the effort (see the notes below).</p>

<h3><a name="_Toc208917372">Individual energy calibrations</a></h3>

<p class=MsoNormal>It is not known how long gain-trimming calibration will
remain valid before discernible differences in calibration between detector
channels will become apparent. <b>Indeed, small differences between channels (pulser
feed-in capacitance) makes doing an individual channel energy calibration essential
right from the start</b>. </p>

<p class=MsoNormal> </p>

<p class=MsoNormal>The spectra for all detectors can be extracted using the
“Display-&gt;Import” menu function in <i>Spectrum Display</i> or saved from
Maia Control’s <i>Maia E Spectra</i> window. If linearization correction has
been performed in real-time by HYMOD, then no further linearization correction
should be needed. The extracted spectra can now be calibrated for energy using a
fit to all spectra recorded for each detector using <i>X-ray Spectrum Fit</i>.</p>

<p class=MsoNormal style='margin-left:0cm'>&nbsp;</p>

<p class=MsoNormal>Once a good fit is obtained to one detector spectra with Cal
parameters free to vary, use the “Fit: All” button to fit all detector
channels. This assumes that the energy calibrations are reasonable now and you
see peaks lining up from detectors across the array when displayed overlaid
together in the GeoPIXE <i>Spectrum Display</i> window (or the <i>Maia Control
E </i>Spectrum window). But initially, the energy calibrations may be quite
different and “Fit All” may struggle. In this case, use the “Rough Initial
Calibration” approach below.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>There are some points of caution and care that need to be
addressed for this to be successful.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>If
possible, avoid including the scatter peaks in the fit. The energy of these may
be in error, and the width and skew of the Compton peak can bias the fit of
energy calibration.</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Use
spectrum Cuts to remove problem regions from spectra, such as the odd-channel
artefacts in the Maia prototypes, or severe pileup peaks and tails.</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Make
sure the lower View range is above any rapid fall-off of the spectrum or the ‘glitch’
peaks.</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Disable
fitting of Tail parameters.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Once all spectra have been fitted, view the results to
detect any problems. Individual spectra may need re-fitting, or bad channels
with broad peaks may need to be deleted from the spectra list. There are two
ways to view the results:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Open
the <i>Fit Results </i>window (using the <i>Spectrum Display</i>
“Window-&gt;Fit Results” menu) and look at the “Fitting” results using the
droplist. Scan down to see any channels with un-usually large RMS fitting
error. View these in <i>Spectrum Display</i> (use <i>Spectrum Select</i> to
toggle the Display status for selected detectors) to see what the problem is
and re-fit.</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Step
through all spectra fits in <i>Spectrum Display</i> (use <i>Spectrum Select</i>
to step through using “Next”) to see what the problem is and re-fit.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><i>Tip: If you display all detector channels a poor fitted
channel may stand out. Use “Highlight” mode in Spectrum Select and click on the
odd spectrum to identify it.</i></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>To re-fit spectra, you may need to fix parameters such as
FWHM or set FWHM manually (use the “Advanced” “Widths” tab and enter or adjust
Mn K FWHM). You may need to move the lower View marker and click on “Use View”
in <i>X-ray Spectrum Fit</i>, and then re-fit. If the energy calibration is
well out, you may need to use the <i>Energy Calibration</i> window to adjust it
to match the peaks to expected energies.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>If all else fails, disable the detector channel by deleting
its spectrum from the list.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Once spectra are fitted successfully, or deleted, save the remaining
good spectra to a file (include “cal” in the name for future reference, e.g.
“999-cal.spec”). Typically, save the energy calibrations to a file in your <b>local
laboratory Config directory (“config/&lt;detector&gt;/energy/”)</b>. This file
can be used with the <i>Maia Control</i> Energy Calibration Load on the HYMOD
panel, or in GeoPIXE with the “Get” button in <i>Sort EVT</i>, with the “Get
ALL Energy Cals” menu in <i>Spectrum Display</i> (see above). Missing detector
channels (spectra deleted as bad fits or broad peaks) will then be disabled in
further analysis.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><i>Tip: Acquire spectra from metal foils that produce nicely
space X-ray lines, and the use the “<b>Add by Detector</b>” spectrum plugin to
add these spectra channel by channel to produce composite spectra with the
combined lines. These are ideal for fitting and refining the energy
calibrations.</i></p>

<h3><a name="_Toc208917373">Rough Initial energy calibration</a></h3>

<p class=MsoNormal>If the energy calibrations are quite bad, and peaks do no
line up making “Fit All” fail to converge on the correct element peaks, then we
need to roughly align them first. One approach uses the spectrum plugin “Cal by
X marker range centroids (2)”. The idea is to select two, well separated peaks
in the spectrum and place X markers around them. Start setting the far-right X
marker first, to the right of a prominent peak, and then click to the left of
the peak (if you pick up the first marker again, try clicking further to the
left for a new marker) to set the next X marker. Then proceed to click further
left and position a marker to the right of the other prominent peak at lower
energy. Then click to position the final X marker left of the lower energy peak.
You should have 4 markers set around 2 peaks. </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Now run the spectrum plugin “Cal by X marker range centroids
(2)”, which will prompt for the energy of the first and second peaks and then
refine the energy calibration of all selected detector channels to align the
centroids of these peaks. If the initial cal was quite far off, you might do
well to repeat this plugin, perhaps with the X markers tighter around the
peaks. When the rough energy calibrations look better, then “Fit All” may
succeed.</p>

<h2><a name="_Toc208917374">Detector Energy Resolution</a></h2>

<p class=MsoNormal>Energy resolution can be measured using a radioactive
source, such as <sup>55</sup>Fe, or using a test target with a well resolved
prominent X-ray line or group. The following illustrates measuring energy
resolution using the Mn K lines from <sup>55</sup>Fe source spectra.</p>

<h3><a name="_Toc208917375">Acquire spectra</a></h3>

<p class=MsoNormal>Acquire spectra from <sup>55</sup>Fe with the source
positioned near the optimum Z distance, near ~2.0-2.5 mm from front face of
Maia. This will ensure that all detector pads are illuminated. Or run beam on a
simple standard, such as the NIST alloy (take care as high count-rates will
degrade energy resolution). Save the spectra to a file, from the <i>Maia E
Spectrum</i> window.</p>

<h3><a name="_Toc208917376">Fit spectra &amp; display FWHM</a></h3>

<p class=MsoNormal>Load these spectra into GeoPIXE and perform these steps on
it, using the indicated plugins:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Import
spectra</b>: Use the “File<span style='font-family:Wingdings'>à</span>Import<span
style='font-family:Wingdings'>à</span>Spectra” menu to select raw blog files.
Once loaded delete the T, X, Y spectra using the <i>Spectrum Select</i> window.</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>“<b>Peak
Mn Centre” plugin</b>: First set the View markers around the Mn K lines, and
then run this plugin, which will set a starting energy calibration for all
spectra, using a constant Gain (Cal A) term. If there is a reasonable existing
energy calibration, then you can skip this step.</p>

<p class=MsoNormal><span style='layout-grid-mode:both'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:72.0pt'><span style='layout-grid-mode:
both'><img width=455 height=275 src="Maia-384-user-help_files/image049.jpg"></span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Fit
spectra</b>: Load the PCM “dummy-Fe-55.pcm” into the <i>X-ray Spectrum Fit</i>
window, which establishes a simple fit setup and a dummy yield file. Then use
“Fit: ALL” to fit all spectra. If using the NIST on Maia Mapper, you might use
a PCM for it, such as
“standards/24100eV/NIST_1243_384D19_24100eV-basic-for-cal.pcm”.</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>Fit
results</b>: Open the <i>Fit Results</i> window. You can see the FWHM (Mn) as
fitted by selecting “Spectra” on the droplist. Save results to a PFR file.</p>

<p class=MsoNormal style='margin-left:78.55pt;text-indent:-18.0pt'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b>“Fit
file Peak FWHM”</b> plugin: This plugin opens a window – select the above PFR
file as the “Fit Results File”. Click OK to show the FWHM map, which displays
these FWHM values on a detector mimic display.</p>

<p class=MsoNormal><span style='layout-grid-mode:both'>&nbsp;</span></p>

<p class=MsoNormal style='margin-left:72.0pt'><img width=390 height=209
src="Maia-384-user-help_files/image050.jpg"></p>

<p class=MsoNormal style='margin-left:60.55pt'>&nbsp;</p>

<p class=MsoNormal style='margin-left:60.55pt'><img width=416 height=398
src="Maia-384-user-help_files/image051.png" alt="image2017-11-15_8-5-50.png"></p>

<p class=MsoNormal style='margin-left:60.55pt'><img width=339 height=359
src="Maia-384-user-help_files/image052.png" alt="image2017-11-15_8-6-8.png"></p>

<h2><a name="_Toc208917377">Relative Noise Width</a></h2>

<p class=MsoNormal>Relative noise width can be measured using the built-in
pulser. </p>

<h3><a name="_Toc208917378">Acquire spectra</a></h3>

<p class=MsoNormal>Acquire spectra using the pulser. The Gain-Trim script can
be used, with Low=High to produce just a single peak in each detector channel.
Save the spectra to a file, from the <i>Maia E Spectrum</i> window.</p>

<h3><a name="_Toc208917379">Fit spectra &amp; display FWHM</a></h3>

<p class=MsoNormal>Load these spectra into GeoPIXE and perform these steps on
it, using the indicated plugin:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>“<b>Plot Pulser FWHM map” </b>plugin: First set the View
markers around all the pulser peaks, and then run this plugin, which will
determine FWHM based on a given energy calibration dispersion (eV/ch).</p>

<p class=MsoNormal><span style='layout-grid-mode:both'>&nbsp;</span></p>

<p class=MsoNormal><span style='layout-grid-mode:both'><img width=601
height=371 src="Maia-384-user-help_files/image053.jpg"></span></p>

<p class=MsoNormal><span style='layout-grid-mode:both'>&nbsp;</span></p>

<p class=MsoNormal><span style='layout-grid-mode:both'><img width=367
height=186 src="Maia-384-user-help_files/image054.jpg"></span></p>

<p class=MsoNormal><span style='layout-grid-mode:both'>&nbsp;</span></p>

<p class=MsoNormal><span style='layout-grid-mode:both'>&nbsp;</span></p>

<p class=MsoNormal><span style='layout-grid-mode:both'><img width=416
height=397 src="Maia-384-user-help_files/image055.jpg"></span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='layout-grid-mode:both'><img width=383
height=387 src="Maia-384-user-help_files/image056.jpg"></span></p>

<h2><a name="_Toc208917380">Using Throttle to Control Data-rates</a></h2>

<p class=MsoNormal>Data rates are often dominated by a major element (e.g. Fe
in iron oxides) or the scatter peaks (e.g. for biological material). The data
for these energies is excessive and superfluous. It can be reduced prior to
storage in the blog files without loss of significant image detail for these
element/features using the “Throttle” mechanism described here.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Throttle scales down certain parts of the spectrum from all
detectors, effectively accepting every n’th event at these energies. The
factors ‘n’ can vary across the spectrum. Important areas of the spectrum are
kept at ‘1’ to avoid any Throttling. . Set-up involves developing this spectrum
of scaling factors.</p>

<h3><a name="_Toc208917381">Representative Spectrum</a></h3>

<p class=MsoNormal>Load (or Import) some representative spectral data, such as
a total spectrum for one detector over a representative scan area. Use the <i>Spectrum
Display</i> menu “Analyze<span style='font-family:Wingdings'>à</span>Throttle”. 
This brings up a panel where you enter the factor to reduce count-rate by,
integrated over the range between the View markers. Move the markers to
surround a strong peak and then click on “Throttle” to throttle that selected
part of the spectrum. This procedure can be repeated for other parts of the
spectrum by moving the View markers and entering a new throttle factor and
clicking on “Throttle”.</p>

<p class=MsoNormal style='margin-left:0cm'>&nbsp;</p>

<p class=MsoNormal><img width=323 height=138
src="Maia-384-user-help_files/image057.png"></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Generally, attack the largest peaks in the spectrum or ones
of little importance (e.g. scatter). The red spectrum overlay shows the result.
The purple spectrum is the vector of throttle scaling factors. These are
limited by Hymod firmware implementation (4 bits) to not exceed 15.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><img width=604 height=413
src="Maia-384-user-help_files/image058.jpg"></p>

<p class=MsoNormal style='margin-left:0cm;text-indent:17.0pt'>&nbsp;</p>

<p class=MsoNormal>The red spectrum is the result after Throttling and the
violet spectrum is the vector of Throttle Factors. If data with Throttling
active is read-back from disk (e.g. Import spectra or <i>Sort EVT</i> in <i>GeoPIXE</i>),
these throttle factors are re-applied to correct spectral data. Typically, save
the Throttle vector to a file in your <b>local laboratory Config directory (“config/&lt;detector&gt;/throttle/”)</b>.</p>

<h3><a name="_Toc208917382">Enabling Throttle in Maia</a></h3>

<p class=MsoNormal>On the HYMOD tab page on<i> Maia Setup</i> window, Load the
Throttle file, “enable throttle” to make sure that Throttle is switched on and
press “Apply to HYMOD”. Since Throttle is intended to reduce data rates to
disk, on the Groups tab page make sure that Throttle is enabled for ET Events
(Group 13).</p>

<h1 style='margin-left:0cm'>&nbsp;</h1>

<h1><a name="_Toc208917383">Maia Data Analysis</a></h1>

<p class=MsoNormal><i>It is recommended to use the worked examples in the
Workshop notes (see “geopixe/Help” directory) that contain more up to date
examples of Maia data analysis.</i></p>

<p class=MsoNormal><i>&nbsp;</i></p>

<p class=MsoNormal><i>See the file “<b>GeoPIXE Worked Example Notes.pdf</b>”.</i></p>

<p class=MsoNormal style='margin-left:0cm'>&nbsp;</p>

<p class=MsoNormal style='margin-left:0cm'>&nbsp;</p>

</div>

</body>

</html>
